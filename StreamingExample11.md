<Initial_Streaming_Response>
Let me provide a comprehensive analysis of the credit performance based on the financial documents.
The credit performance shows some gradual deterioration across multiple metrics, though the changes remain relatively controlled. Here's my detailed analysis:
		Loan Growth and Quality:
		Total gross loans have shown steady growth from $42,000M in 2024Q1 to $45,000M in 2025Q1, representing a 7.1% increase.
		However, credit quality metrics have experienced some deterioration during this period.
		Asset Quality Trends:
		Non-performing assets (NPAs) have increased steadily from $350M to $390M over five quarters
		The allowance for loan losses has grown proportionally from $350M to $390M, suggesting management is proactively addressing credit risk
		90+ days past due loans have increased from $120M to $135M
		Non-accrual loans have risen from $260M to $290M
		Credit Loss Metrics:
		Net charge-offs have shown an upward trend from $25M to $32M
		The provision for credit losses has increased each quarter, from $40M in 2024Q1 to $60M in 2025Q1, indicating management expects continued credit deterioration
Let me generate some visualizations to better illustrate these trends.
Let me provide a comprehensive analysis of the credit performance based on the financial documents. The credit performance shows some gradual deterioration across multiple metrics, though the changes remain relatively controlled. Here's my detailed analysis: 1. Loan Growth and Quality: - Total gross loans have shown steady growth from $42,000M in 2024Q1 to $45,000M in 2025Q1, representing a 7.1% increase. - However, credit quality metrics have experienced some deterioration during this period. 2. Asset Quality Trends: - Non-performing assets (NPAs) have increased steadily from $350M to $390M over five quarters - The allowance for loan losses has grown proportionally from $350M to $390M, suggesting management is proactively addressing credit risk - 90+ days past due loans have increased from $120M to $135M - Non-accrual loans have risen from $260M to $290M 3. Credit Loss Metrics: - Net charge-offs have shown an upward trend from $25M to $32M - The provision for credit losses has increased each quarter, from $40M in 2024Q1 to $60M in 2025Q1, indicating management expects continued credit deterioration Let me generate some visualizations to better illustrate these trends.
</Initial_Streaming_Response>

<Post_Visualization_Streaming_Response>
Rendered then Disappeared 
</Post_Visualization_Streaming_Response>

<JavaScript_Console_Output>
[Info] Successfully preconnected to https://fonts.gstatic.com/
[Info] Successfully preconnected to https://fonts.googleapis.com/
[Error] Failed to load resource: the server responded with a status of 400 () (font, line 0)
[Error] Failed to load resource: the server responded with a status of 404 (Not Found) (favicon.ico, line 0)
[Log] [Fast Refresh] rebuilding
[Log] [Fast Refresh] done in 1360ms
[Log] ğŸŒ API Service Available
[Log] Use __apiService to access the API directly in the console
[Log] Sending POST request to http://localhost:8000/api/conversation
[Log] Sending POST request to http://localhost:8000/api/conversation
[Error] Failed to load resource: the server responded with a status of 400 () (font, line 0)
[Log] Created conversation session: 4e8e6f06-b00c-4065-a43c-35a297a8a38e
[Log] Created conversation session: â€“ "4e8e6f06-b00c-4065-a43c-35a297a8a38e"
[Log] Created conversation session: 9e990413-21e4-43a1-953d-16626b6f1c4c
[Log] Validating conversation exists: â€“ "4e8e6f06-b00c-4065-a43c-35a297a8a38e"
[Log] Sending GET request to http://localhost:8000/api/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e
[Log] Starting WebSocket connection to: â€“ "ws://localhost:8000/ws/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e"
[Log] Current isConnected state before connection: â€“ false
[Log] WebSocket onopen event fired for conversation: â€“ "4e8e6f06-b00c-4065-a43c-35a297a8a38e"
[Log] WebSocket connected and isConnected set to true for conversation: â€“ "4e8e6f06-b00c-4065-a43c-35a297a8a38e"
[Log] File selected: â€“ "Bank_5Q_Trend_Report.pdf"
[Log] Validating file: â€“ "Bank_5Q_Trend_Report.pdf"
[Log] File validation successful
[Log] Uploading document...
[Log] Upload progress: 0.00%, Stage: Starting upload
[Log] Uploading file to http://localhost:8000/api/documents/upload
[Log] Upload progress: 40.00%, Stage: Uploading file
[Log] Polling for document processing completion...
[Log] Upload progress: 40.00%, Stage: Processing document
[Log] Upload progress: 40.00%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 1: processing
[Log] Upload progress: 40.27%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 2: processing
[Log] Upload progress: 40.53%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 3: processing
[Log] Upload progress: 40.80%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 4: processing
[Log] Upload progress: 41.07%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 5: processing
[Log] Upload progress: 41.33%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 6: processing
[Log] Upload progress: 41.60%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 7: processing
[Log] Upload progress: 41.87%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 8: processing
[Log] Upload progress: 42.13%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 9: processing
[Log] Upload progress: 42.40%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 10: processing
[Log] Upload progress: 42.67%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 11: processing
[Log] Upload progress: 42.93%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 12: processing
[Log] Upload progress: 43.20%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 13: processing
[Log] Upload progress: 43.47%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 14: processing
[Log] Upload progress: 43.73%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 15: processing
[Log] Upload progress: 44.00%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document status after attempt 16: completed
[Log] Verifying financial data...
[Log] Upload progress: 80.00%, Stage: Verifying financial data
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/check-financial-data
[Log] Document needs financial data verification: â€“ "Document accepted for financial analysis"
[Log] Upload progress: 85.00%, Stage: Enhancing financial data
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/check-financial-data
[Log] Sending POST request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/verify-financial-data
[Log] Financial data verification result: â€“ {success: true, message: "Document content verified for analysis"}
[Log] Upload progress: 90.00%, Stage: Retrieving enhanced data
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Upload progress: 100.00%, Stage: Document ready
[Log] Document verification completed: â€“ {metadata: Object, contentType: "other", extractionTimestamp: "2025-06-23T05:18:10.186Z", â€¦}
{metadata: Object, contentType: "other", extractionTimestamp: "2025-06-23T05:18:10.186Z", periods: ["2024Q1", "2024Q2", "2024Q3", "2024Q4", "2025Q1"], extractedData: Object, â€¦}Object
[Log] Associating document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 with conversation 4e8e6f06-b00c-4065-a43c-35a297a8a38e
[Log] Sending POST request to http://localhost:8000/api/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e/document/7fc31dbc-618b-4a71-bb74-e043ca2d9896
[Log] Document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 added to conversation 4e8e6f06-b00c-4065-a43c-35a297a8a38e
[Log] Document successfully associated with conversation
[Error] Failed to load resource: the server responded with a status of 404 (Not Found) (types.js.map, line 0)
[Log] PDFViewer unmounting, cleaning up resources
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/citations
[Log] Deprecated API usage: The `enhanceTextSelection` functionality will be removed in the future. (x3)
[Log] Submit conditions: useStreaming=true, conversationId=4e8e6f06-b00c-4065-a43c-35a297a8a38e, isConnected=true
[Log] Using WebSocket streaming for message submission
[Log] ğŸ” State check on message_start: â€“ {messagePhase: null, activeMessageId: null, streamingMessageId: null, â€¦}
{messagePhase: null, activeMessageId: null, streamingMessageId: null, phaseTransitions: 0}Object
[Log] ğŸš€ Starting new message: 23ead672-f168-4b87-b9ab-f7cb56058d0a
[Log] ğŸ“ Building initial streaming: 3 chars
[Log] ğŸ“ Initial streaming update: 3 chars
[Log] ğŸ“ Building initial streaming: 46 chars
[Log] ğŸ“ Initial streaming update: 46 chars
[Log] ğŸ“ Building initial streaming: 99 chars
[Log] ğŸ“ Initial streaming update: 99 chars
[Log] ğŸ“ Building initial streaming: 134 chars
[Log] ğŸ“ Initial streaming update: 134 chars
[Log] ğŸ“ Building initial streaming: 172 chars
[Log] ğŸ“ Initial streaming update: 172 chars
[Log] ğŸ“ Building initial streaming: 228 chars
[Log] ğŸ“ Initial streaming update: 228 chars
[Log] ğŸ“ Building initial streaming: 263 chars
[Log] ğŸ“ Initial streaming update: 263 chars
[Log] ğŸ“ Building initial streaming: 296 chars
[Log] ğŸ“ Initial streaming update: 296 chars
[Log] ğŸ“ Building initial streaming: 342 chars
[Log] ğŸ“ Initial streaming update: 342 chars
[Log] ğŸ“ Building initial streaming: 355 chars
[Log] ğŸ“ Initial streaming update: 355 chars
[Log] ğŸ“ Building initial streaming: 373 chars
[Log] ğŸ“ Initial streaming update: 373 chars
[Log] ğŸ“ Building initial streaming: 398 chars
[Log] ğŸ“ Initial streaming update: 398 chars
[Log] ğŸ“ Building initial streaming: 428 chars
[Log] ğŸ“ Initial streaming update: 428 chars
[Log] ğŸ“ Building initial streaming: 487 chars
[Log] ğŸ“ Initial streaming update: 487 chars
[Log] ğŸ“ Building initial streaming: 510 chars
[Log] ğŸ“ Initial streaming update: 510 chars
[Log] ğŸ“ Building initial streaming: 533 chars
[Log] ğŸ“ Initial streaming update: 533 chars
[Log] ğŸ“ Building initial streaming: 562 chars
[Log] ğŸ“ Initial streaming update: 562 chars
[Log] ğŸ“ Building initial streaming: 591 chars
[Log] ğŸ“ Initial streaming update: 591 chars
[Log] ğŸ“ Building initial streaming: 606 chars
[Log] ğŸ“ Initial streaming update: 606 chars
[Log] ğŸ“ Building initial streaming: 626 chars
[Log] ğŸ“ Initial streaming update: 626 chars
[Log] ğŸ“ Building initial streaming: 656 chars
[Log] ğŸ“ Initial streaming update: 656 chars
[Log] ğŸ“ Building initial streaming: 687 chars
[Log] ğŸ“ Initial streaming update: 687 chars
[Log] ğŸ“ Building initial streaming: 698 chars
[Log] ğŸ“ Initial streaming update: 698 chars
[Log] ğŸ“ Building initial streaming: 753 chars
[Log] ğŸ“ Initial streaming update: 753 chars
[Log] ğŸ“ Building initial streaming: 764 chars
[Log] ğŸ“ Initial streaming update: 764 chars
[Log] ğŸ“ Building initial streaming: 804 chars
[Log] ğŸ“ Initial streaming update: 804 chars
[Log] ğŸ“ Building initial streaming: 818 chars
[Log] ğŸ“ Initial streaming update: 818 chars
[Log] ğŸ“ Building initial streaming: 839 chars
[Log] ğŸ“ Initial streaming update: 839 chars
[Log] ğŸ“ Building initial streaming: 860 chars
[Log] ğŸ“ Initial streaming update: 860 chars
[Log] ğŸ“ Building initial streaming: 881 chars
[Log] ğŸ“ Initial streaming update: 881 chars
[Log] ğŸ“ Building initial streaming: 908 chars
[Log] ğŸ“ Initial streaming update: 908 chars
[Log] ğŸ“ Building initial streaming: 945 chars
[Log] ğŸ“ Initial streaming update: 945 chars
[Log] ğŸ“ Building initial streaming: 957 chars
[Log] ğŸ“ Initial streaming update: 957 chars
[Log] ğŸ“ Building initial streaming: 985 chars
[Log] ğŸ“ Initial streaming update: 985 chars
[Log] ğŸ“ Building initial streaming: 1029 chars
[Log] ğŸ“ Initial streaming update: 1029 chars
[Log] ğŸ“ Building initial streaming: 1040 chars
[Log] ğŸ“ Initial streaming update: 1040 chars
[Log] ğŸ“ Building initial streaming: 1056 chars
[Log] ğŸ“ Initial streaming update: 1056 chars
[Log] ğŸ“ Building initial streaming: 1098 chars
[Log] ğŸ“ Initial streaming update: 1098 chars
[Log] ğŸ“ Building initial streaming: 1137 chars
[Log] ğŸ“ Initial streaming update: 1137 chars
[Log] ğŸ“ Building initial streaming: 1192 chars
[Log] ğŸ“ Initial streaming update: 1192 chars
[Log] ğŸ” State check on tool_start: â€“ {messagePhase: "initial", activeMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", streamingMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", â€¦}
{messagePhase: "initial", activeMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", streamingMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", phaseTransitions: 1}Object
[Log] ğŸ”§ Tool started: generate_graph_data in phase initial
[Log] âœ… Completing initial streaming message: 1192 chars
[Log] Streaming message update: â€“ {id: "23ead672-f168-4b87-b9ab-f7cb56058d0a", sessionId: "4e8e6f06-b00c-4065-a43c-35a297a8a38e", timestamp: "2025-06-23T05:22:14.895Z", â€¦}
{id: "23ead672-f168-4b87-b9ab-f7cb56058d0a", sessionId: "4e8e6f06-b00c-4065-a43c-35a297a8a38e", timestamp: "2025-06-23T05:22:14.895Z", role: "assistant", content: "Let me provide a comprehensive analysis of the creâ€¦visualizations to better illustrate these trends.", â€¦}Object
[Log] ğŸ”§ Tool generate_graph_data (toolu_01Np281q6NtuetvSeZ5UYS9T) in progress
[Log] Sending POST request to http://localhost:8000/api/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e/generate-followups?limit=3
[Log] Sending POST request to http://localhost:8000/api/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e/generate-followups?limit=3
[Log] Generated 3 follow-up questions for conversation 4e8e6f06-b00c-4065-a43c-35a297a8a38e (x2)
[Log] ğŸ” State check on tool_start: â€“ {messagePhase: "tools", activeMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", streamingMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", â€¦}
{messagePhase: "tools", activeMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", streamingMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", phaseTransitions: 2}Object
[Log] ğŸ”§ Tool started: generate_table_data in phase tools
[Log] âš ï¸ Tool started in phase tools - not completing initial message
[Log] ğŸ”§ Tool generate_table_data (toolu_01N2ejUaxuyyf8mWaPFqJ6gG) in progress
[Log] ğŸ” State check on tool_start: â€“ {messagePhase: "tools", activeMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", streamingMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", â€¦}
{messagePhase: "tools", activeMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", streamingMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", phaseTransitions: 2}Object
[Log] ğŸ”§ Tool started: generate_financial_metric in phase tools
[Log] âš ï¸ Tool started in phase tools - not completing initial message
[Log] ğŸ”§ Tool generate_financial_metric (toolu_011sazxMWUv5B4v9j3UFZapP) in progress
[Log] ğŸ” State check on tool_start: â€“ {messagePhase: "tools", activeMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", streamingMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", â€¦}
{messagePhase: "tools", activeMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", streamingMessageId: "23ead672-f168-4b87-b9ab-f7cb56058d0a", phaseTransitions: 2}Object
[Log] ğŸ”§ Tool started: generate_financial_metric in phase tools
[Log] âš ï¸ Tool started in phase tools - not completing initial message
[Log] ğŸ”§ Tool generate_financial_metric (toolu_01L1dFVvHcnm5MZb1T4doRBB) in progress
[Log] ğŸ“Š Transitioning to post-tools phase
[Log] ğŸ’¬ Building post-visualization content: 3 chars
[Log] ğŸ“Š Post-visualization content update: 3 chars
[Log] ğŸ’¬ Building post-visualization content: 56 chars
[Log] ğŸ“Š Post-visualization content update: 56 chars
[Log] ğŸ’¬ Building post-visualization content: 95 chars
[Log] ğŸ“Š Post-visualization content update: 95 chars
[Log] ğŸ’¬ Building post-visualization content: 146 chars
[Log] ğŸ“Š Post-visualization content update: 146 chars
[Log] ğŸ’¬ Building post-visualization content: 173 chars
[Log] ğŸ“Š Post-visualization content update: 173 chars
[Log] ğŸ’¬ Building post-visualization content: 209 chars
[Log] ğŸ“Š Post-visualization content update: 209 chars
[Log] ğŸ’¬ Building post-visualization content: 247 chars
[Log] ğŸ“Š Post-visualization content update: 247 chars
[Log] ğŸ’¬ Building post-visualization content: 277 chars
[Log] ğŸ“Š Post-visualization content update: 277 chars
[Log] ğŸ’¬ Building post-visualization content: 345 chars
[Log] ğŸ“Š Post-visualization content update: 345 chars
[Log] ğŸ’¬ Building post-visualization content: 369 chars
[Log] ğŸ“Š Post-visualization content update: 369 chars
[Log] ğŸ’¬ Building post-visualization content: 410 chars
[Log] ğŸ“Š Post-visualization content update: 410 chars
[Log] ğŸ’¬ Building post-visualization content: 442 chars
[Log] ğŸ“Š Post-visualization content update: 442 chars
[Log] ğŸ’¬ Building post-visualization content: 451 chars
[Log] ğŸ“Š Post-visualization content update: 451 chars
[Log] ğŸ’¬ Building post-visualization content: 472 chars
[Log] ğŸ“Š Post-visualization content update: 472 chars
[Log] ğŸ’¬ Building post-visualization content: 502 chars
[Log] ğŸ“Š Post-visualization content update: 502 chars
[Log] ğŸ’¬ Building post-visualization content: 529 chars
[Log] ğŸ“Š Post-visualization content update: 529 chars
[Log] ğŸ’¬ Building post-visualization content: 564 chars
[Log] ğŸ“Š Post-visualization content update: 564 chars
[Log] ğŸ’¬ Building post-visualization content: 599 chars
[Log] ğŸ“Š Post-visualization content update: 599 chars
[Log] ğŸ’¬ Building post-visualization content: 653 chars
[Log] ğŸ“Š Post-visualization content update: 653 chars
[Log] ğŸ’¬ Building post-visualization content: 679 chars
[Log] ğŸ“Š Post-visualization content update: 679 chars
[Log] ğŸ’¬ Building post-visualization content: 731 chars
[Log] ğŸ“Š Post-visualization content update: 731 chars
[Log] ğŸ’¬ Building post-visualization content: 765 chars
[Log] ğŸ“Š Post-visualization content update: 765 chars
[Log] ğŸ’¬ Building post-visualization content: 809 chars
[Log] ğŸ“Š Post-visualization content update: 809 chars
[Log] ğŸ’¬ Building post-visualization content: 863 chars
[Log] ğŸ“Š Post-visualization content update: 863 chars
[Log] ğŸ’¬ Building post-visualization content: 892 chars
[Log] ğŸ“Š Post-visualization content update: 892 chars
[Log] ğŸ’¬ Building post-visualization content: 927 chars
[Log] ğŸ“Š Post-visualization content update: 927 chars
[Log] ğŸ’¬ Building post-visualization content: 968 chars
[Log] ğŸ“Š Post-visualization content update: 968 chars
[Log] ğŸ’¬ Building post-visualization content: 1002 chars
[Log] ğŸ“Š Post-visualization content update: 1002 chars
[Log] ğŸ Message complete in phase: post-tools
[Log] Sending GET request to http://localhost:8000/api/conversation/message/23ead672-f168-4b87-b9ab-f7cb56058d0a
[Log] ğŸ§¹ Cleaning up after phase transitions: initial â†’ tools â†’ post-tools
[Log] ğŸ“Š DB Message: 0 visualizations
[Log] ğŸ’¬ Post-viz text: 1002 chars
[Log] Checking 3 messages for cumulative visualization data...
[Log] Examining assistant message 2: â€“ "ID: 23ead672-f168-4b87-b9ab-f7cb56058d0a" â€“ "Has 0 analysis blocks"
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] Checking 3 messages for cumulative visualization data...
[Log] Examining assistant message 2: â€“ "ID: 23ead672-f168-4b87-b9ab-f7cb56058d0a" â€“ "Has 0 analysis blocks"
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] PDFViewer unmounting, cleaning up resources
[Log] Checking 3 messages for cumulative visualization data...
[Log] Examining assistant message 2: â€“ "ID: 23ead672-f168-4b87-b9ab-f7cb56058d0a" â€“ "Has 0 analysis blocks"
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] Checking 3 messages for cumulative visualization data...
[Log] Examining assistant message 2: â€“ "ID: 23ead672-f168-4b87-b9ab-f7cb56058d0a" â€“ "Has 0 analysis blocks"
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] PDFViewer unmounting, cleaning up resources
[Log] Sending GET request to http://localhost:8000/api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/citations
[Log] Deprecated API usage: The `enhanceTextSelection` functionality will be removed in the future. (x3)
</JavaScript_Console_Output>

<Backend_Logs>
(venv) alexcardell@Alexs-MacBook-Pro backend % cd /Users/alexcardell/AlexCoding_Local/cfin/backend && PYTHONPATH=$PYTHONPATH:/Users/alexcardell/AlexCoding_Local/cfin/backend python -m uvicorn app.main:app --reload --port 8000
INFO:     Will watch for changes in these directories: ['/Users/alexcardell/AlexCoding_Local/cfin/backend']
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [40327] using StatReload
INFO:root:Loaded environment variables from /Users/alexcardell/AlexCoding_Local/cfin/.env
INFO:root:ANTHROPIC_API_KEY loaded: sk-ant-a...TQAA
INFO:app.main:CORS: Allowing origins: ['http://localhost:3000', 'http://localhost:3001', 'http://localhost:3002', 'http://localhost:3003', 'http://127.0.0.1:3000', 'http://127.0.0.1:3001', 'http://127.0.0.1:3002', 'http://127.0.0.1:3003', 'http://127.0.0.1:49937', 'http://127\\.0\\.0\\.1:\\d+', 'http://127.0.0.1:64142']
INFO:     Started server process [40329]
INFO:     Waiting for application startup.
INFO:app.main:Initializing database...
INFO:utils.init_db:Creating database tables...
INFO:utils.init_db:Database tables created successfully.
INFO:utils.init_db:Default user already exists.
INFO:utils.init_db:Database initialization completed successfully.
INFO:app.main:Database initialization completed successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:61673 - "OPTIONS /api/conversation HTTP/1.1" 200 OK
INFO:     127.0.0.1:61674 - "OPTIONS /api/conversation HTTP/1.1" 200 OK
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.conversation:Created conversation: 4e8e6f06-b00c-4065-a43c-35a297a8a38e for user: default-user
INFO:app.routes.conversation:Created conversation: 9e990413-21e4-43a1-953d-16626b6f1c4c for user: default-user
INFO:     127.0.0.1:61674 - "POST /api/conversation HTTP/1.1" 201 Created
INFO:     127.0.0.1:61673 - "POST /api/conversation HTTP/1.1" 201 Created
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:     127.0.0.1:61674 - "GET /api/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e HTTP/1.1" 200 OK
INFO:app.routes.websocket:WebSocket endpoint called for conversation: 4e8e6f06-b00c-4065-a43c-35a297a8a38e, user: default-user
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:     ('127.0.0.1', 61673) - "WebSocket /ws/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e" [accepted]
INFO:app.routes.websocket:WebSocket connected: default-user_4e8e6f06-b00c-4065-a43c-35a297a8a38e_1750655884503
INFO:app.routes.websocket:WebSocket connection established for conversation: 4e8e6f06-b00c-4065-a43c-35a297a8a38e
INFO:     connection open
INFO:app.routes.websocket:Found conversation: 4e8e6f06-b00c-4065-a43c-35a297a8a38e
INFO:     127.0.0.1:61676 - "OPTIONS /api/documents/upload HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:utils.storage:File 7fc31dbc-618b-4a71-bb74-e043ca2d9896.pdf saved to ./uploads/7fc31dbc-618b-4a71-bb74-e043ca2d9896.pdf
INFO:     127.0.0.1:61676 - "POST /api/documents/upload HTTP/1.1" 200 OK
INFO:pdf_processing.document_service:Starting optimized processing of document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 (Bank_5Q_Trend_Report.pdf) with Claude Files API
INFO:pdf_processing.document_service:No cached file_id for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896, performing full processing
INFO:pdf_processing.api_service:Processing PDF: Bank_5Q_Trend_Report.pdf with Claude API using native PDF support.
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/files "HTTP/1.1 200 OK"
INFO:utils.file_cache:Cached file_id=file_011CQQb1agffUpRHFFcadW74 for content hash=9c15100a12f1a9ad... (expires: 2025-09-21 00:18:10, cache size: 1)
INFO:audit.pdf_access:PDF_ACCESS: {'timestamp': 'AUTO', 'operation': 'upload', 'file_id': 'file_011CQQb1agffUpRHFFcadW74', 'user_context': 'system', 'file_size_bytes': 29802, 'privacy_note': 'PDF content not logged for compliance'}
INFO:pdf_processing.claude_file_client:Uploaded Bank_5Q_Trend_Report.pdf (0.0 MB) â†’ file_011CQQb1agffUpRHFFcadW74
INFO:pdf_processing.api_service:Generated Claude file_id file_011CQQb1agffUpRHFFcadW74 for Bank_5Q_Trend_Report.pdf
INFO:pdf_processing.api_service:Analyzing document type for Bank_5Q_Trend_Report.pdf
INFO:pdf_processing.api_service:Analyzing document type for Bank_5Q_Trend_Report.pdf using file_id=file_011CQQb1agffUpRHFFcadW74
INFO:pdf_processing.model_router:Using Haiku for light tools set() with 1000 tokens (haiku_calls=1, sonnet_calls=0)
INFO:pdf_processing.api_service:Model router selected claude-3-5-haiku-20241022 for document type analysis
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (non-streaming): 117 (Custom estimate: 117)
INFO:pdf_processing.api_service:Throttling based on token count: 117 (SDK count: 117, Custom estimate: 117)
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
WARNING:pdf_processing.api_service:Invalid document type 'balance_sheet, income_statement, credit_quality_kpis', using OTHER
INFO:pdf_processing.api_service:Document Bank_5Q_Trend_Report.pdf classified as other with periods: ['2024Q1', '2024Q2', '2024Q3', '2024Q4', '2025Q1']
INFO:pdf_processing.api_service:Document Bank_5Q_Trend_Report.pdf classified as: other with periods: ['2024Q1', '2024Q2', '2024Q3', '2024Q4', '2025Q1']
INFO:pdf_processing.api_service:Extracting structured financial data and citations for Bank_5Q_Trend_Report.pdf
INFO:pdf_processing.api_service:Extracting structured financial data with citations from: Bank_5Q_Trend_Report.pdf using file_id file_011CQQb1agffUpRHFFcadW74
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (non-streaming): 177 (Custom estimate: 101)
INFO:pdf_processing.api_service:Throttling based on token count: 177 (SDK count: 177, Custom estimate: 101)
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Successfully parsed financial JSON from Claude's response.
INFO:pdf_processing.api_service:Captured Claude's preamble text, length: 190
INFO:pdf_processing.api_service:Extracted 0 citations for Bank_5Q_Trend_Report.pdf
INFO:pdf_processing.api_service:Structured financial data keys for Bank_5Q_Trend_Report.pdf: ['time_periods', 'balance_sheet', 'income_statement', 'credit_quality', 'claude_textual_output_accompanying_json']
INFO:pdf_processing.api_service:Added claude_file_id file_011CQQb1agffUpRHFFcadW74 to extracted_data for Bank_5Q_Trend_Report.pdf
INFO:pdf_processing.document_service:Processed document using Files API: PDF Bank_5Q_Trend_Report.pdf processed using Claude's native PDF support via Files API
INFO:pdf_processing.document_service:Extracted claude_file_id file_011CQQb1agffUpRHFFcadW74 from processed document data
INFO:pdf_processing.document_service:Stored claude_file_id file_011CQQb1agffUpRHFFcadW74 in database for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896
INFO:pdf_processing.document_service:Updating document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 content with Claude optimizations using Files API
INFO:pdf_processing.document_service:Document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 processed with Claude optimizations. File ID: file_011CQQb1agffUpRHFFcadW74
INFO:pdf_processing.document_service:Storing 0 citations for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896
INFO:pdf_processing.document_service:Successfully completed optimized processing for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.document:Document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 accepted for financial analysis
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/check-financial-data HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.document:Document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 accepted for financial analysis
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/check-financial-data HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "OPTIONS /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/verify-financial-data HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.document:Document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 has extracted_data with keys: ['time_periods', 'balance_sheet', 'income_statement', 'credit_quality', 'claude_textual_output_accompanying_json', 'claude_file_id']
INFO:     127.0.0.1:61676 - "POST /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/verify-financial-data HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61676 - "OPTIONS /api/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e/document/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:     127.0.0.1:61676 - "POST /api/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e/document/7fc31dbc-618b-4a71-bb74-e043ca2d9896 HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.document:Retrieving file for document: 7fc31dbc-618b-4a71-bb74-e043ca2d9896
INFO:app.routes.document:Returning binary PDF data for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896, size: 29802 bytes
INFO:     127.0.0.1:61676 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/file HTTP/1.1" 200 OK
INFO:     127.0.0.1:61684 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/citations HTTP/1.1" 200 OK
INFO:app.routes.websocket:WEBSOCKET_FLOW: Created streaming session default-user_4e8e6f06-b00c-4065-a43c-35a297a8a38e_1750655884503_4e8e6f06-b00c-4065-a43c-35a297a8a38e with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: Sent initial message_start event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: Starting conversation processing for conversation: 4e8e6f06-b00c-4065-a43c-35a297a8a38e
INFO:repositories.document_repository:Retrieving document content using file path: 7fc31dbc-618b-4a71-bb74-e043ca2d9896.pdf
INFO:repositories.document_repository:Requesting file from storage service for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896
INFO:repositories.document_repository:Retrieved PDF content for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896: 29802 bytes
INFO:repositories.document_repository:Document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 has claude_file_id: file_011CQQb1agffUpRHFFcadW74 (native PDF support available)
INFO:repositories.document_repository:PDF document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 uses claude_file_id for native support - raw_text not required
INFO:repositories.document_repository:Extracted data available for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896: ['time_periods', 'balance_sheet', 'income_statement', 'credit_quality', 'claude_textual_output_accompanying_json', 'claude_file_id']
INFO:repositories.document_repository:Successfully retrieved content for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896
INFO:services.conversation_service:Retrieved content for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896: content size=29802, raw_text size=0
INFO:services.conversation_service:Document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 available content types: content, extracted_data
INFO:services.conversation_service:Added document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 to context for conversation 4e8e6f06-b00c-4065-a43c-35a297a8a38e
INFO:repositories.document_repository:Retrieving document content using file path: 7fc31dbc-618b-4a71-bb74-e043ca2d9896.pdf
INFO:repositories.document_repository:Requesting file from storage service for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896
INFO:repositories.document_repository:Retrieved PDF content for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896: 29802 bytes
INFO:repositories.document_repository:Document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 has claude_file_id: file_011CQQb1agffUpRHFFcadW74 (native PDF support available)
INFO:repositories.document_repository:PDF document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 uses claude_file_id for native support - raw_text not required
INFO:repositories.document_repository:Extracted data available for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896: ['time_periods', 'balance_sheet', 'income_statement', 'credit_quality', 'claude_textual_output_accompanying_json', 'claude_file_id']
INFO:repositories.document_repository:Successfully retrieved content for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896
INFO:services.conversation_service:Added document 7fc31dbc-618b-4a71-bb74-e043ca2d9896 with Files API file_id: file_011CQQb1agffUpRHFFcadW74
INFO:services.conversation_service:Using unified streaming approach with tools available for conversation 4e8e6f06-b00c-4065-a43c-35a297a8a38e
INFO:services.conversation_service:Using Files API claude_file_id file_011CQQb1agffUpRHFFcadW74 for unified streaming analysis
INFO:pdf_processing.api_service:Starting streaming analyze_with_visualization_tools for query: 'How has credit performed?...'
INFO:pdf_processing.api_service:Streaming visualization analysis turn 1/5
INFO:pdf_processing.model_router:Using Sonnet for tools {'generate_comparative_period', 'generate_table_data', 'generate_graph_data', 'generate_financial_metric'} with 46 tokens (haiku_calls=1, sonnet_calls=1)
INFO:pdf_processing.api_service:Executing tool interaction turn with model_router selected model: claude-3-5-sonnet-20241022, 4 tools available, streaming: True
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (streaming): 4321 (Custom estimate: 39)
INFO:pdf_processing.api_service:Throttling based on token count: 4321 (SDK count: 4321, Custom estimate: 39)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
ERROR:sqlalchemy.pool.impl.NullPool:The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-34, started daemon 6179893248)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
/Users/alexcardell/AlexCoding_Local/venv/lib/python3.9/site-packages/pydantic/_internal/_core_utils.py:301: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-34, started daemon 6179893248)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
  for v in schema['choices']:
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_start event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Filtering out duplicate message_start event for session default-user_4e8e6f06-b00c-4065-a43c-35a297a8a38e_1750655884503_4e8e6f06-b00c-4065-a43c-35a297a8a38e
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_start event
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 3 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 3
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 3 chars
INFO:services.conversation_service:ğŸ“ Content updated: 3 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 3 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 46 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 46
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 46 chars
INFO:services.conversation_service:ğŸ“ Content updated: 46 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 46 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 99 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 99
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 99 chars
INFO:services.conversation_service:ğŸ“ Content updated: 99 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 99 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 134 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 134
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 134 chars
INFO:services.conversation_service:ğŸ“ Content updated: 134 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 134 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 172 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 172
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 172 chars
INFO:services.conversation_service:ğŸ“ Content updated: 172 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 172 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 228 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 228
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 228 chars
INFO:services.conversation_service:ğŸ“ Content updated: 228 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 228 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 263 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 263
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 263 chars
INFO:services.conversation_service:ğŸ“ Content updated: 263 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 263 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 296 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 296
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 296 chars
INFO:services.conversation_service:ğŸ“ Content updated: 296 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 296 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 342 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 342
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 342 chars
INFO:services.conversation_service:ğŸ“ Content updated: 342 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 342 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 355 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 355
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 355 chars
INFO:services.conversation_service:ğŸ“ Content updated: 355 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 355 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 373 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 373
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 373 chars
INFO:services.conversation_service:ğŸ“ Content updated: 373 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 373 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 398 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 398
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 398 chars
INFO:services.conversation_service:ğŸ“ Content updated: 398 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 398 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 428 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 428
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 428 chars
INFO:services.conversation_service:ğŸ“ Content updated: 428 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 428 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 487 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 487
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 487 chars
INFO:services.conversation_service:ğŸ“ Content updated: 487 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 487 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 510 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 510
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 510 chars
INFO:services.conversation_service:ğŸ“ Content updated: 510 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 510 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 533 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 533
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 533 chars
INFO:services.conversation_service:ğŸ“ Content updated: 533 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 533 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 562 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 562
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 562 chars
INFO:services.conversation_service:ğŸ“ Content updated: 562 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 562 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 591 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 591
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 591 chars
INFO:services.conversation_service:ğŸ“ Content updated: 591 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 591 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 606 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 606
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 606 chars
INFO:services.conversation_service:ğŸ“ Content updated: 606 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 606 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 626 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 626
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 626 chars
INFO:services.conversation_service:ğŸ“ Content updated: 626 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 626 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 656 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 656
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 656 chars
INFO:services.conversation_service:ğŸ“ Content updated: 656 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 656 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 687 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 687
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 687 chars
INFO:services.conversation_service:ğŸ“ Content updated: 687 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 687 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 698 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 698
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 698 chars
INFO:services.conversation_service:ğŸ“ Content updated: 698 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 698 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 753 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 753
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 753 chars
INFO:services.conversation_service:ğŸ“ Content updated: 753 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 753 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 764 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 764
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 764 chars
INFO:services.conversation_service:ğŸ“ Content updated: 764 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 764 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 804 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 804
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 804 chars
INFO:services.conversation_service:ğŸ“ Content updated: 804 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 804 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 818 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 818
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 818 chars
INFO:services.conversation_service:ğŸ“ Content updated: 818 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 818 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 839 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 839
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 839 chars
INFO:services.conversation_service:ğŸ“ Content updated: 839 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 839 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 860 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 860
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 860 chars
INFO:services.conversation_service:ğŸ“ Content updated: 860 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 860 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 881 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 881
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 881 chars
INFO:services.conversation_service:ğŸ“ Content updated: 881 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 881 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 908 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 908
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 908 chars
INFO:services.conversation_service:ğŸ“ Content updated: 908 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 908 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 945 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 945
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 945 chars
INFO:services.conversation_service:ğŸ“ Content updated: 945 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 945 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 957 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 957
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 957 chars
INFO:services.conversation_service:ğŸ“ Content updated: 957 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 957 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 985 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 985
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 985 chars
INFO:services.conversation_service:ğŸ“ Content updated: 985 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 985 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1029 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 1029
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1029 chars
INFO:services.conversation_service:ğŸ“ Content updated: 1029 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1029 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1040 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 1040
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1040 chars
INFO:services.conversation_service:ğŸ“ Content updated: 1040 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1040 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1056 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 1056
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1056 chars
INFO:services.conversation_service:ğŸ“ Content updated: 1056 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1056 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1098 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 1098
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1098 chars
INFO:services.conversation_service:ğŸ“ Content updated: 1098 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1098 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1137 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 1137
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1137 chars
INFO:services.conversation_service:ğŸ“ Content updated: 1137 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1137 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1192 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 1192
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1192 chars
INFO:services.conversation_service:ğŸ“ Content updated: 1192 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1192 chars
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for content_block_stop event
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for tool_start event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_start event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_start - tool_id=toolu_01Np281q6NtuetvSeZ5UYS9T, tool_name=generate_graph_data
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:pdf_processing.api_service:Sending request to Claude API with 1 messages, streaming: False
INFO:pdf_processing.api_service:Sending request to Claude API with 1 messages, streaming: False
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (generate_response non-streaming): 531
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (generate_response non-streaming): 531
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (non-streaming): 531 (Custom estimate: 531)
INFO:pdf_processing.api_service:Throttling based on token count: 531 (SDK count: 531, Custom estimate: 531)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (non-streaming): 531 (Custom estimate: 531)
INFO:pdf_processing.api_service:Throttling based on token count: 531 (SDK count: 531, Custom estimate: 531)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:     127.0.0.1:61717 - "POST /api/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e/generate-followups?limit=3 HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:     127.0.0.1:61716 - "POST /api/conversation/4e8e6f06-b00c-4065-a43c-35a297a8a38e/generate-followups?limit=3 HTTP/1.1" 200 OK
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for content_block_stop event
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_delta event
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_stop event
INFO:pdf_processing.api_service:Raw tool input from Claude for generate_graph_data: type=<class 'dict'>
WARNING:app.routes.websocket:Correcting message_id from msg_016FHtaFN7foP8oJR55A3BZs to 23ead672-f168-4b87-b9ab-f7cb56058d0a for tool_complete event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01Np281q6NtuetvSeZ5UYS9T, tool_name=generate_graph_data
INFO:pdf_processing.api_service:Turn 1: Initial streaming text preserved (1192 chars)
INFO:pdf_processing.api_service:Received 1 tool calls from streaming response
INFO:pdf_processing.api_service:Tool call: generate_graph_data (ID: toolu_01Np281q6NtuetvSeZ5UYS9T)
INFO:pdf_processing.api_service:Processing streaming tool generate_graph_data (ID: toolu_01Np281q6NtuetvSeZ5UYS9T)
INFO:pdf_processing.api_service:Tool generate_graph_data (ID: toolu_01Np281q6NtuetvSeZ5UYS9T) - input type: <class 'dict'>
INFO:pdf_processing.api_service:Tool generate_graph_data (ID: toolu_01Np281q6NtuetvSeZ5UYS9T) - dict input keys: ['chartType', 'config', 'data', 'chartConfig']
INFO:utils.tool_processing:Processing generate_graph_data (ID: toolu_01Np281q6NtuetvSeZ5UYS9T) - input type: <class 'dict'>
INFO:utils.tool_processing:Starting process_chart_input with input type: <class 'dict'>
INFO:utils.tool_processing:Chart input keys: ['chartType', 'config', 'data', 'chartConfig']
INFO:utils.tool_processing:Chart config type: <class 'str'>
INFO:utils.tool_processing:Chart data type: <class 'list'>, length: 5
INFO:utils.tool_processing:Chart chartConfig type: <class 'dict'>
WARNING:utils.tool_processing:Chart config is a JSON string, parsing it
INFO:utils.tool_processing:Successfully parsed config JSON string
INFO:utils.tool_processing:Chart config keys: ['title', 'xAxisKey', 'xAxisLabel', 'yAxisLabel', 'description']
INFO:utils.tool_processing:Successfully got original_data: type=<class 'list'>
INFO:utils.tool_processing:Chart type: line
INFO:utils.tool_processing:Chart config settings type: <class 'dict'>
INFO:utils.tool_processing:x_axis_key: period
INFO:utils.tool_processing:Transforming chart data to {x, y} format required by ChartDataItem model
INFO:utils.tool_processing:Line chart with multiple series (['npa', 'nonaccrual', 'past_due']) - keeping flat format
INFO:utils.tool_processing:Successfully processed chart: Credit Quality Trends
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01Np281q6NtuetvSeZ5UYS9T, tool_name=generate_graph_data
INFO:pdf_processing.api_service:Streaming visualization analysis turn 2/5
INFO:pdf_processing.model_router:Using Sonnet for tools {'generate_comparative_period', 'generate_table_data', 'generate_graph_data', 'generate_financial_metric'} with 878 tokens (haiku_calls=1, sonnet_calls=2)
INFO:pdf_processing.api_service:Executing tool interaction turn with model_router selected model: claude-3-5-sonnet-20241022, 4 tools available, streaming: True
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (streaming): 5419 (Custom estimate: 337)
INFO:pdf_processing.api_service:Throttling based on token count: 5419 (SDK count: 5419, Custom estimate: 337)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
WARNING:app.routes.websocket:Correcting message_id from msg_01XPeSztfSHrC19omfjpDFe9 to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_start event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Filtering out duplicate message_start event for session default-user_4e8e6f06-b00c-4065-a43c-35a297a8a38e_1750655884503_4e8e6f06-b00c-4065-a43c-35a297a8a38e
WARNING:app.routes.websocket:Correcting message_id from msg_01XPeSztfSHrC19omfjpDFe9 to 23ead672-f168-4b87-b9ab-f7cb56058d0a for tool_start event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_start event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_start - tool_id=toolu_01N2ejUaxuyyf8mWaPFqJ6gG, tool_name=generate_table_data
WARNING:app.routes.websocket:Correcting message_id from msg_01XPeSztfSHrC19omfjpDFe9 to 23ead672-f168-4b87-b9ab-f7cb56058d0a for content_block_stop event
WARNING:app.routes.websocket:Correcting message_id from msg_01XPeSztfSHrC19omfjpDFe9 to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_delta event
WARNING:app.routes.websocket:Correcting message_id from msg_01XPeSztfSHrC19omfjpDFe9 to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_stop event
INFO:pdf_processing.api_service:Raw tool input from Claude for generate_table_data: type=<class 'dict'>
WARNING:app.routes.websocket:Correcting message_id from msg_01XPeSztfSHrC19omfjpDFe9 to 23ead672-f168-4b87-b9ab-f7cb56058d0a for tool_complete event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01N2ejUaxuyyf8mWaPFqJ6gG, tool_name=generate_table_data
INFO:pdf_processing.api_service:Received 1 tool calls from streaming response
INFO:pdf_processing.api_service:Tool call: generate_table_data (ID: toolu_01N2ejUaxuyyf8mWaPFqJ6gG)
INFO:pdf_processing.api_service:Processing streaming tool generate_table_data (ID: toolu_01N2ejUaxuyyf8mWaPFqJ6gG)
INFO:pdf_processing.api_service:Tool generate_table_data (ID: toolu_01N2ejUaxuyyf8mWaPFqJ6gG) - input type: <class 'dict'>
INFO:pdf_processing.api_service:Tool generate_table_data (ID: toolu_01N2ejUaxuyyf8mWaPFqJ6gG) - dict input keys: ['tableType', 'config', 'data']
INFO:utils.tool_processing:Processing generate_table_data (ID: toolu_01N2ejUaxuyyf8mWaPFqJ6gG) - input type: <class 'dict'>
INFO:utils.tool_processing:Starting process_table_input with input type: <class 'dict'>
INFO:utils.tool_processing:Table input keys: ['tableType', 'config', 'data']
INFO:utils.tool_processing:Table config type: <class 'str'>
INFO:utils.tool_processing:Table data type: <class 'list'>, length: 4
WARNING:utils.tool_processing:Table config is a JSON string, parsing it
INFO:utils.tool_processing:Successfully parsed table config JSON string
INFO:utils.tool_processing:Successfully processed table: Credit Quality Metrics
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01N2ejUaxuyyf8mWaPFqJ6gG, tool_name=generate_table_data
INFO:pdf_processing.api_service:Streaming visualization analysis turn 3/5
INFO:pdf_processing.model_router:Using Sonnet for tools {'generate_comparative_period', 'generate_table_data', 'generate_graph_data', 'generate_financial_metric'} with 1479 tokens (haiku_calls=1, sonnet_calls=3)
INFO:pdf_processing.api_service:Executing tool interaction turn with model_router selected model: claude-3-5-sonnet-20241022, 4 tools available, streaming: True
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (streaming): 6352 (Custom estimate: 337)
INFO:pdf_processing.api_service:Throttling based on token count: 6352 (SDK count: 6352, Custom estimate: 337)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
WARNING:app.routes.websocket:Correcting message_id from msg_01NQiTDrvaAzZAt2TjeECJyK to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_start event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Filtering out duplicate message_start event for session default-user_4e8e6f06-b00c-4065-a43c-35a297a8a38e_1750655884503_4e8e6f06-b00c-4065-a43c-35a297a8a38e
WARNING:app.routes.websocket:Correcting message_id from msg_01NQiTDrvaAzZAt2TjeECJyK to 23ead672-f168-4b87-b9ab-f7cb56058d0a for tool_start event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_start event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_start - tool_id=toolu_011sazxMWUv5B4v9j3UFZapP, tool_name=generate_financial_metric
WARNING:app.routes.websocket:Correcting message_id from msg_01NQiTDrvaAzZAt2TjeECJyK to 23ead672-f168-4b87-b9ab-f7cb56058d0a for content_block_stop event
WARNING:app.routes.websocket:Correcting message_id from msg_01NQiTDrvaAzZAt2TjeECJyK to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_delta event
WARNING:app.routes.websocket:Correcting message_id from msg_01NQiTDrvaAzZAt2TjeECJyK to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_stop event
INFO:pdf_processing.api_service:Raw tool input from Claude for generate_financial_metric: type=<class 'dict'>
WARNING:app.routes.websocket:Correcting message_id from msg_01NQiTDrvaAzZAt2TjeECJyK to 23ead672-f168-4b87-b9ab-f7cb56058d0a for tool_complete event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_011sazxMWUv5B4v9j3UFZapP, tool_name=generate_financial_metric
INFO:pdf_processing.api_service:Received 1 tool calls from streaming response
INFO:pdf_processing.api_service:Tool call: generate_financial_metric (ID: toolu_011sazxMWUv5B4v9j3UFZapP)
INFO:pdf_processing.api_service:Processing streaming tool generate_financial_metric (ID: toolu_011sazxMWUv5B4v9j3UFZapP)
INFO:pdf_processing.api_service:Tool generate_financial_metric (ID: toolu_011sazxMWUv5B4v9j3UFZapP) - input type: <class 'dict'>
INFO:pdf_processing.api_service:Tool generate_financial_metric (ID: toolu_011sazxMWUv5B4v9j3UFZapP) - dict input keys: ['category', 'name', 'period', 'value', 'unit', 'isEstimated']
INFO:utils.tool_processing:Processing generate_financial_metric (ID: toolu_011sazxMWUv5B4v9j3UFZapP) - input type: <class 'dict'>
INFO:utils.tool_processing:Successfully processed financial metric: NPAs to Total Loans
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_011sazxMWUv5B4v9j3UFZapP, tool_name=generate_financial_metric
INFO:pdf_processing.api_service:Streaming visualization analysis turn 4/5
INFO:pdf_processing.model_router:Using Sonnet for tools {'generate_comparative_period', 'generate_table_data', 'generate_graph_data', 'generate_financial_metric'} with 1595 tokens (haiku_calls=1, sonnet_calls=4)
INFO:pdf_processing.api_service:Executing tool interaction turn with model_router selected model: claude-3-5-sonnet-20241022, 4 tools available, streaming: True
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (streaming): 6565 (Custom estimate: 337)
INFO:pdf_processing.api_service:Throttling based on token count: 6565 (SDK count: 6565, Custom estimate: 337)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
WARNING:app.routes.websocket:Correcting message_id from msg_01CGAnY44pqDVQdiSBi9SZtV to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_start event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Filtering out duplicate message_start event for session default-user_4e8e6f06-b00c-4065-a43c-35a297a8a38e_1750655884503_4e8e6f06-b00c-4065-a43c-35a297a8a38e
WARNING:app.routes.websocket:Correcting message_id from msg_01CGAnY44pqDVQdiSBi9SZtV to 23ead672-f168-4b87-b9ab-f7cb56058d0a for tool_start event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_start event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_start - tool_id=toolu_01L1dFVvHcnm5MZb1T4doRBB, tool_name=generate_financial_metric
WARNING:app.routes.websocket:Correcting message_id from msg_01CGAnY44pqDVQdiSBi9SZtV to 23ead672-f168-4b87-b9ab-f7cb56058d0a for content_block_stop event
WARNING:app.routes.websocket:Correcting message_id from msg_01CGAnY44pqDVQdiSBi9SZtV to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_delta event
WARNING:app.routes.websocket:Correcting message_id from msg_01CGAnY44pqDVQdiSBi9SZtV to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_stop event
INFO:pdf_processing.api_service:Raw tool input from Claude for generate_financial_metric: type=<class 'dict'>
WARNING:app.routes.websocket:Correcting message_id from msg_01CGAnY44pqDVQdiSBi9SZtV to 23ead672-f168-4b87-b9ab-f7cb56058d0a for tool_complete event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01L1dFVvHcnm5MZb1T4doRBB, tool_name=generate_financial_metric
INFO:pdf_processing.api_service:Received 1 tool calls from streaming response
INFO:pdf_processing.api_service:Tool call: generate_financial_metric (ID: toolu_01L1dFVvHcnm5MZb1T4doRBB)
INFO:pdf_processing.api_service:Processing streaming tool generate_financial_metric (ID: toolu_01L1dFVvHcnm5MZb1T4doRBB)
INFO:pdf_processing.api_service:Tool generate_financial_metric (ID: toolu_01L1dFVvHcnm5MZb1T4doRBB) - input type: <class 'dict'>
INFO:pdf_processing.api_service:Tool generate_financial_metric (ID: toolu_01L1dFVvHcnm5MZb1T4doRBB) - dict input keys: ['category', 'name', 'period', 'value', 'unit', 'isEstimated']
INFO:utils.tool_processing:Processing generate_financial_metric (ID: toolu_01L1dFVvHcnm5MZb1T4doRBB) - input type: <class 'dict'>
INFO:utils.tool_processing:Successfully processed financial metric: Net Charge-off Rate
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01L1dFVvHcnm5MZb1T4doRBB, tool_name=generate_financial_metric
INFO:pdf_processing.api_service:Streaming visualization analysis turn 5/5
INFO:pdf_processing.model_router:Using Sonnet for tools {'generate_comparative_period', 'generate_table_data', 'generate_graph_data', 'generate_financial_metric'} with 1710 tokens (haiku_calls=1, sonnet_calls=5)
INFO:pdf_processing.api_service:Executing tool interaction turn with model_router selected model: claude-3-5-sonnet-20241022, 4 tools available, streaming: True
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (streaming): 6778 (Custom estimate: 337)
INFO:pdf_processing.api_service:Throttling based on token count: 6778 (SDK count: 6778, Custom estimate: 337)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_start event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Filtering out duplicate message_start event for session default-user_4e8e6f06-b00c-4065-a43c-35a297a8a38e_1750655884503_4e8e6f06-b00c-4065-a43c-35a297a8a38e
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_start event
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 3 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 3
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 3 chars
INFO:services.conversation_service:ğŸ“ Content updated: 3 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 3 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 56 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 56
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 56 chars
INFO:services.conversation_service:ğŸ“ Content updated: 56 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 56 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 95 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 95
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 95 chars
INFO:services.conversation_service:ğŸ“ Content updated: 95 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 95 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 146 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 146
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 146 chars
INFO:services.conversation_service:ğŸ“ Content updated: 146 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 146 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 173 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 173
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 173 chars
INFO:services.conversation_service:ğŸ“ Content updated: 173 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 173 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 209 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 209
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 209 chars
INFO:services.conversation_service:ğŸ“ Content updated: 209 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 209 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 247 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 247
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 247 chars
INFO:services.conversation_service:ğŸ“ Content updated: 247 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 247 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 277 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 277
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 277 chars
INFO:services.conversation_service:ğŸ“ Content updated: 277 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 277 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 345 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 345
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 345 chars
INFO:services.conversation_service:ğŸ“ Content updated: 345 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 345 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 369 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 369
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 369 chars
INFO:services.conversation_service:ğŸ“ Content updated: 369 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 369 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 410 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 410
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 410 chars
INFO:services.conversation_service:ğŸ“ Content updated: 410 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 410 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 442 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 442
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 442 chars
INFO:services.conversation_service:ğŸ“ Content updated: 442 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 442 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 451 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 451
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 451 chars
INFO:services.conversation_service:ğŸ“ Content updated: 451 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 451 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 472 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 472
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 472 chars
INFO:services.conversation_service:ğŸ“ Content updated: 472 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 472 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 502 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 502
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 502 chars
INFO:services.conversation_service:ğŸ“ Content updated: 502 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 502 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 529 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 529
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 529 chars
INFO:services.conversation_service:ğŸ“ Content updated: 529 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 529 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 564 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 564
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 564 chars
INFO:services.conversation_service:ğŸ“ Content updated: 564 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 564 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 599 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 599
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 599 chars
INFO:services.conversation_service:ğŸ“ Content updated: 599 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 599 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 653 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 653
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 653 chars
INFO:services.conversation_service:ğŸ“ Content updated: 653 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 653 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 679 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 679
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 679 chars
INFO:services.conversation_service:ğŸ“ Content updated: 679 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 679 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 731 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 731
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 731 chars
INFO:services.conversation_service:ğŸ“ Content updated: 731 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 731 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 765 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 765
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 765 chars
INFO:services.conversation_service:ğŸ“ Content updated: 765 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 765 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 809 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 809
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 809 chars
INFO:services.conversation_service:ğŸ“ Content updated: 809 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 809 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 863 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 863
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 863 chars
INFO:services.conversation_service:ğŸ“ Content updated: 863 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 863 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 892 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 892
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 892 chars
INFO:services.conversation_service:ğŸ“ Content updated: 892 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 892 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 927 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 927
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 927 chars
INFO:services.conversation_service:ğŸ“ Content updated: 927 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 927 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 968 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 968
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 968 chars
INFO:services.conversation_service:ğŸ“ Content updated: 968 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 968 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for text_delta event
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1002 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 1002
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1002 chars
INFO:services.conversation_service:ğŸ“ Content updated: 1002 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1002 chars
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for content_block_stop event
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_delta event
WARNING:app.routes.websocket:Correcting message_id from msg_01LLt818r4D85QzorVUFc7sp to 23ead672-f168-4b87-b9ab-f7cb56058d0a for message_stop event
INFO:pdf_processing.api_service:Turn 5: Adding new content (1002 chars)
INFO:pdf_processing.api_service:Streaming visualization analysis completed: no more tools
INFO:pdf_processing.api_service:Streaming visualization analysis completed: 1 charts, 1 tables, 2 metrics. Analysis text length: 2196
INFO:services.conversation_service:Current assistant message content length: 1002
INFO:services.conversation_service:Analysis text length: 2196
INFO:services.conversation_service:ğŸ“ Using streaming content (1002 chars)
INFO:repositories.conversation_repository:Updated and re-fetched message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:repositories.conversation_repository:Message content length: 1002
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1002 chars
INFO:services.conversation_service:âœ… Database updated with final content: 1002 chars
INFO:services.conversation_service:Sent message_update event for 23ead672-f168-4b87-b9ab-f7cb56058d0a after streaming complete
INFO:services.conversation_service:DEBUG: result.get('metrics'): [{'category': 'Credit Quality', 'name': 'NPAs to Total Loans', 'period': '2025Q1', 'value': 0.87, 'unit': '%', 'isEstimated': False}, {'category': 'Credit Quality', 'name': 'Net Charge-off Rate', 'period': '2025Q1', 'value': 0.071, 'unit': '%', 'isEstimated': False}]
INFO:services.conversation_service:DEBUG: accumulated_metrics: [{'category': 'Credit Quality', 'name': 'NPAs to Total Loans', 'period': '2025Q1', 'value': 0.87, 'unit': '%', 'isEstimated': False}, {'category': 'Credit Quality', 'name': 'Net Charge-off Rate', 'period': '2025Q1', 'value': 0.071, 'unit': '%', 'isEstimated': False}]
INFO:services.conversation_service:Processing visualizations for conversation 4e8e6f06-b00c-4065-a43c-35a297a8a38e: charts=1, tables=1, metrics=2
INFO:services.conversation_service:Processing chart: Credit Quality Trends
INFO:services.conversation_service:Processing table: Credit Quality Metrics
INFO:services.conversation_service:Processing metric: NPAs to Total Loans
INFO:services.conversation_service:Processing metric: Net Charge-off Rate
INFO:services.conversation_service:Storing 4 analysis blocks for streaming message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:services.conversation_service:ATOMIC: Using existing transaction for message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:services.conversation_service:ATOMIC: Refreshed message 23ead672-f168-4b87-b9ab-f7cb56058d0a content length: 1002 chars
INFO:repositories.conversation_repository:Added analysis block 'Credit Quality Trends' (type: chart) to message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:services.conversation_service:ATOMIC: Stored analysis block 1/4: Credit Quality Trends
INFO:repositories.conversation_repository:Added analysis block 'Credit Quality Metrics' (type: table) to message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:services.conversation_service:ATOMIC: Stored analysis block 2/4: Credit Quality Metrics
INFO:repositories.conversation_repository:Added analysis block 'NPAs to Total Loans' (type: metric) to message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:services.conversation_service:ATOMIC: Stored analysis block 3/4: NPAs to Total Loans
INFO:repositories.conversation_repository:Added analysis block 'Net Charge-off Rate' (type: metric) to message 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:services.conversation_service:ATOMIC: Stored analysis block 4/4: Net Charge-off Rate
INFO:services.conversation_service:ATOMIC: Transaction complete - message 23ead672-f168-4b87-b9ab-f7cb56058d0a has 4 analysis blocks
INFO:services.conversation_service:Sending message_complete event for conversation 4e8e6f06-b00c-4065-a43c-35a297a8a38e after analysis blocks stored
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting message_complete event with message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: Marking session default-user_4e8e6f06-b00c-4065-a43c-35a297a8a38e_1750655884503_4e8e6f06-b00c-4065-a43c-35a297a8a38e as inactive after message_complete
INFO:services.conversation_service:message_complete event sent for conversation 4e8e6f06-b00c-4065-a43c-35a297a8a38e after analysis blocks
INFO:app.routes.websocket:WEBSOCKET_FLOW: Streaming message processing completed for message_id: 23ead672-f168-4b87-b9ab-f7cb56058d0a
INFO:app.routes.websocket:WEBSOCKET_FLOW: Conversation 4e8e6f06-b00c-4065-a43c-35a297a8a38e processing finished successfully
INFO:app.routes.websocket:WEBSOCKET_FLOW: Cleaning up session default-user_4e8e6f06-b00c-4065-a43c-35a297a8a38e_1750655884503_4e8e6f06-b00c-4065-a43c-35a297a8a38e
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:     127.0.0.1:61721 - "GET /api/conversation/message/23ead672-f168-4b87-b9ab-f7cb56058d0a HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.document:Retrieving file for document: 7fc31dbc-618b-4a71-bb74-e043ca2d9896
INFO:app.routes.document:Returning binary PDF data for document 7fc31dbc-618b-4a71-bb74-e043ca2d9896, size: 29802 bytes
INFO:     127.0.0.1:61722 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/file HTTP/1.1" 200 OK
INFO:     127.0.0.1:61723 - "GET /api/documents/7fc31dbc-618b-4a71-bb74-e043ca2d9896/citations HTTP/1.1" 200 OK
</Backend_Logs>