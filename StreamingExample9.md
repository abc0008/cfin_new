<Initial_Streaming_Response>
Let me provide a comprehensive analysis of the credit performance based on the financial documents.

The credit performance shows some concerning trends with gradually deteriorating metrics across multiple indicators, though the deterioration appears managed and orderly rather than severe:

1. Loan Growth and Quality:
- Total gross loans have grown steadily from $42,000M in 2024Q1 to $45,000M in 2025Q1, representing healthy growth of 7.1%
- However, this growth has been accompanied by increasing credit stress indicators

2. Credit Quality Indicators:
- Non-performing assets (NPAs) have increased consistently each quarter, from $350M to $390M
- The allowance for loan losses has grown from $350M to $390M, matching the NPA growth
- Net charge-offs have shown an upward trend, increasing from $25M to $32M quarterly
- Non-accrual loans have risen from $260M to $290M, indicating growing credit stress

3. Past Due and Problem Loans:
- 90+ days past due loans have increased from $120M to $135M
- Troubled Debt Restructuring (TDR) balances have grown modestly from $50M to $56M

Let me generate some visualizations to better illustrate these trends.




</Initial_Streaming_Response>

<Post_Visualization_Streaming_Response>
Rendered then disappeared with a "[Log] 🧹 Cleaned up streaming state for next message" log message.

[Error] Failed to load resource: the server responded with a status of 404 (Not Found) (types.js.map, line 0)
[Log] Tool complete: Setting missing streamingMessageId to msg_014JgsTPcck42npAyJ2wZUXH
[Log] Tool complete: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 🔄 Starting new message - reset streaming state
[Log] Message start: Set streamingMessageId to msg_012QMMRSi7L7PDwVzZfSEfEu
[Log] 📝 Building initial streaming: 3 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 3 chars
[Log] 📝 Building initial streaming: 32 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 32 chars
[Log] 📝 Building initial streaming: 40 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 40 chars
[Log] 📝 Building initial streaming: 56 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 56 chars
[Log] 📝 Building initial streaming: 66 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 66 chars
[Log] 📝 Building initial streaming: 72 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 72 chars
[Log] 📝 Building initial streaming: 78 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 78 chars
[Log] 📝 Building initial streaming: 93 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 93 chars
[Log] 📝 Building initial streaming: 113 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 113 chars
[Log] 📝 Building initial streaming: 119 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 119 chars
[Log] 📝 Building initial streaming: 133 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 133 chars
[Log] 📝 Building initial streaming: 145 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 145 chars
[Log] 📝 Building initial streaming: 153 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 153 chars
[Log] 📝 Building initial streaming: 161 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 161 chars
[Log] 📝 Building initial streaming: 184 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 184 chars
[Log] 📝 Building initial streaming: 221 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 221 chars
[Log] 📝 Building initial streaming: 222 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 222 chars
[Log] 📝 Building initial streaming: 227 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 227 chars
[Log] 📝 Building initial streaming: 238 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 238 chars
[Log] 📝 Building initial streaming: 245 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 245 chars
[Log] 📝 Building initial streaming: 248 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 248 chars
[Log] 📝 Building initial streaming: 261 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 261 chars
[Log] 📝 Building initial streaming: 280 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 280 chars
[Log] 📝 Building initial streaming: 289 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 289 chars
[Log] 📝 Building initial streaming: 303 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 303 chars
[Log] 📝 Building initial streaming: 314 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 314 chars
[Log] 📝 Building initial streaming: 319 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 319 chars
[Log] 📝 Building initial streaming: 343 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 343 chars
[Log] 📝 Building initial streaming: 352 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 352 chars
[Log] 📝 Building initial streaming: 353 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 353 chars
[Log] 📝 Building initial streaming: 361 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 361 chars
[Log] 📝 Building initial streaming: 380 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 380 chars
[Log] 📝 Building initial streaming: 390 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 390 chars
[Log] 📝 Building initial streaming: 417 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 417 chars
[Log] 📝 Building initial streaming: 422 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 422 chars
[Log] 📝 Building initial streaming: 430 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 430 chars
[Log] 📝 Building initial streaming: 439 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 439 chars
[Log] 📝 Building initial streaming: 440 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 440 chars
[Log] 📝 Building initial streaming: 448 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 448 chars
[Log] 📝 Building initial streaming: 462 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 462 chars
[Log] 📝 Building initial streaming: 468 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 468 chars
[Log] 📝 Building initial streaming: 491 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 491 chars
[Log] 📝 Building initial streaming: 524 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 524 chars
[Log] 📝 Building initial streaming: 545 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 545 chars
[Log] 📝 Building initial streaming: 561 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 561 chars
[Log] 📝 Building initial streaming: 576 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 576 chars
[Log] 📝 Building initial streaming: 603 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 603 chars
[Log] 📝 Building initial streaming: 629 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 629 chars
[Log] 📝 Building initial streaming: 649 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 649 chars
[Log] 📝 Building initial streaming: 660 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 660 chars
[Log] 📝 Building initial streaming: 687 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 687 chars
[Log] 📝 Building initial streaming: 708 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 708 chars
[Log] 📝 Building initial streaming: 724 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 724 chars
[Log] 📝 Building initial streaming: 741 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 741 chars
[Log] 📝 Building initial streaming: 751 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 751 chars
[Log] 📝 Building initial streaming: 761 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 761 chars
[Log] 📝 Building initial streaming: 767 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 767 chars
[Log] 📝 Building initial streaming: 784 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 784 chars
[Log] 🏁 Message complete: toolsStarted=false, messageId=072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 No tools used - completing streaming message now
[Log] 🧹 Cleaned up streaming state for next message

</Post_Visualization_Streaming_Response>

<JavaScript_Console_Output>
[Info] Successfully preconnected to https://fonts.googleapis.com/
[Info] Successfully preconnected to https://fonts.gstatic.com/
[Error] Failed to load resource: the server responded with a status of 400 () (font, line 0)
[Error] Failed to load resource: the server responded with a status of 400 () (font, line 0)
[Log] 🌐 API Service Available
[Log] Use __apiService to access the API directly in the console
[Log] Sending POST request to http://localhost:8000/api/conversation
[Log] Sending POST request to http://localhost:8000/api/conversation
[Log] Created conversation session: 00e8c126-e99d-4ee5-8b9b-54c4f1670782
[Log] Created conversation session: e887f5fd-7c23-41ed-bc93-ad1c991fe3e9
[Log] Created conversation session: – "e887f5fd-7c23-41ed-bc93-ad1c991fe3e9"
[Log] Validating conversation exists: – "e887f5fd-7c23-41ed-bc93-ad1c991fe3e9"
[Log] Sending GET request to http://localhost:8000/api/conversation/e887f5fd-7c23-41ed-bc93-ad1c991fe3e9
[Log] Starting WebSocket connection to: – "ws://localhost:8000/ws/conversation/e887f5fd-7c23-41ed-bc93-ad1c991fe3e9"
[Log] Current isConnected state before connection: – false
[Log] WebSocket onopen event fired for conversation: – "e887f5fd-7c23-41ed-bc93-ad1c991fe3e9"
[Log] WebSocket connected and isConnected set to true for conversation: – "e887f5fd-7c23-41ed-bc93-ad1c991fe3e9"
[Log] File selected: – "Bank_5Q_Trend_Report.pdf"
[Log] Validating file: – "Bank_5Q_Trend_Report.pdf"
[Log] File validation successful
[Log] Uploading document...
[Log] Upload progress: 0.00%, Stage: Starting upload
[Log] Uploading file to http://localhost:8000/api/documents/upload
[Log] Upload progress: 40.00%, Stage: Uploading file
[Log] Polling for document processing completion...
[Log] Upload progress: 40.00%, Stage: Processing document
[Log] Upload progress: 40.00%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 1: processing
[Log] Upload progress: 40.27%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 2: processing
[Log] Upload progress: 40.53%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 3: processing
[Log] Upload progress: 40.80%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 4: processing
[Log] Upload progress: 41.07%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 5: processing
[Log] Upload progress: 41.33%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 6: processing
[Log] Upload progress: 41.60%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 7: processing
[Log] Upload progress: 41.87%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 8: processing
[Log] Upload progress: 42.13%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 9: processing
[Log] Upload progress: 42.40%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 10: processing
[Log] Upload progress: 42.67%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 11: processing
[Log] Upload progress: 42.93%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 12: processing
[Log] Upload progress: 43.20%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 13: processing
[Log] Upload progress: 43.47%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 14: processing
[Log] Upload progress: 43.73%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 15: processing
[Log] Upload progress: 44.00%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 16: processing
[Log] Upload progress: 44.27%, Stage: Processing document
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document status after attempt 17: completed
[Log] Verifying financial data...
[Log] Upload progress: 80.00%, Stage: Verifying financial data
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/check-financial-data
[Log] Document needs financial data verification: – "Document accepted for financial analysis"
[Log] Upload progress: 85.00%, Stage: Enhancing financial data
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/check-financial-data
[Log] Sending POST request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/verify-financial-data
[Log] Financial data verification result: – {success: true, message: "Document content verified for analysis"}
[Log] Upload progress: 90.00%, Stage: Retrieving enhanced data
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Upload progress: 100.00%, Stage: Document ready
[Log] Document verification completed: – {metadata: Object, contentType: "other", extractionTimestamp: "2025-06-21T04:27:55.010Z", …}
{metadata: Object, contentType: "other", extractionTimestamp: "2025-06-21T04:27:55.010Z", periods: ["2024Q1", "2024Q2", "2024Q3", "2024Q4", "2025Q1"], extractedData: Object, …}Object
[Log] Associating document c79dd122-8e9d-4931-a334-b9bc94cf4c80 with conversation e887f5fd-7c23-41ed-bc93-ad1c991fe3e9
[Log] Sending POST request to http://localhost:8000/api/conversation/e887f5fd-7c23-41ed-bc93-ad1c991fe3e9/document/c79dd122-8e9d-4931-a334-b9bc94cf4c80
[Log] Document c79dd122-8e9d-4931-a334-b9bc94cf4c80 added to conversation e887f5fd-7c23-41ed-bc93-ad1c991fe3e9
[Log] Document successfully associated with conversation
[Log] [Fast Refresh] rebuilding
[Log] PDFViewer unmounting, cleaning up resources
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/citations
[Log] [Fast Refresh] done in 223ms
[Log] [Fast Refresh] done in 298ms
[Log] Deprecated API usage: The `enhanceTextSelection` functionality will be removed in the future.
[Error] Source Map loading errors (x2)
[Error] Failed to load resource: the server responded with a status of 404 (Not Found) (types.js.map, line 0)
[Error] Failed to load resource: the server responded with a status of 404 (Not Found) (types.js.map, line 0)
[Log] Deprecated API usage: The `enhanceTextSelection` functionality will be removed in the future. (x2)
[Log] Checking 1 messages for cumulative visualization data...
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] Checking 1 messages for cumulative visualization data...
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] PDFViewer unmounting, cleaning up resources
[Log] Checking 1 messages for cumulative visualization data...
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] Checking 1 messages for cumulative visualization data...
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] Submit conditions: useStreaming=true, conversationId=e887f5fd-7c23-41ed-bc93-ad1c991fe3e9, isConnected=true
[Log] Using WebSocket streaming for message submission
[Log] Checking 2 messages for cumulative visualization data...
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] Checking 2 messages for cumulative visualization data...
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] 🔄 Starting new message - reset streaming state
[Log] Message start: Set streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 🔄 Starting new message - reset streaming state
[Log] Message start: Set streamingMessageId to msg_012nTHRLrYmW8axTgcNwUCY4
[Log] 📝 Building initial streaming: 3 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 3 chars
[Log] 📝 Building initial streaming: 14 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 14 chars
[Log] 📝 Building initial streaming: 16 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 16 chars
[Log] 📝 Building initial streaming: 46 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 46 chars
[Log] 📝 Building initial streaming: 78 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 78 chars
[Log] 📝 Building initial streaming: 99 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 99 chars
[Log] 📝 Building initial streaming: 104 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 104 chars
[Log] 📝 Building initial streaming: 111 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 111 chars
[Log] 📝 Building initial streaming: 129 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 129 chars
[Log] 📝 Building initial streaming: 145 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 145 chars
[Log] 📝 Building initial streaming: 157 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 157 chars
[Log] 📝 Building initial streaming: 167 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 167 chars
[Log] 📝 Building initial streaming: 189 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 189 chars
[Log] 📝 Building initial streaming: 205 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 205 chars
[Log] 📝 Building initial streaming: 217 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 217 chars
[Log] 📝 Building initial streaming: 228 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 228 chars
[Log] 📝 Building initial streaming: 250 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 250 chars
[Log] 📝 Building initial streaming: 261 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 261 chars
[Log] 📝 Building initial streaming: 289 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 289 chars
[Log] 📝 Building initial streaming: 299 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 299 chars
[Log] 📝 Building initial streaming: 309 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 309 chars
[Log] 📝 Building initial streaming: 327 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 327 chars
[Log] 📝 Building initial streaming: 350 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 350 chars
[Log] 📝 Building initial streaming: 368 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 368 chars
[Log] 📝 Building initial streaming: 376 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 376 chars
[Log] 📝 Building initial streaming: 382 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 382 chars
[Log] 📝 Building initial streaming: 390 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 390 chars
[Log] 📝 Building initial streaming: 399 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 399 chars
[Log] 📝 Building initial streaming: 406 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 406 chars
[Log] 📝 Building initial streaming: 440 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 440 chars
[Log] 📝 Building initial streaming: 452 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 452 chars
[Log] 📝 Building initial streaming: 469 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 469 chars
[Log] 📝 Building initial streaming: 500 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 500 chars
[Log] 📝 Building initial streaming: 525 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 525 chars
[Log] 📝 Building initial streaming: 536 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 536 chars
[Log] 📝 Building initial streaming: 563 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 563 chars
[Log] 📝 Building initial streaming: 592 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 592 chars
[Log] 📝 Building initial streaming: 620 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 620 chars
[Log] 📝 Building initial streaming: 639 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 639 chars
[Log] 📝 Building initial streaming: 648 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 648 chars
[Log] 📝 Building initial streaming: 655 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 655 chars
[Log] 📝 Building initial streaming: 685 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 685 chars
[Log] 📝 Building initial streaming: 701 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 701 chars
[Log] 📝 Building initial streaming: 721 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 721 chars
[Log] 📝 Building initial streaming: 736 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 736 chars
[Log] 📝 Building initial streaming: 765 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 765 chars
[Log] 📝 Building initial streaming: 793 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 793 chars
[Log] 📝 Building initial streaming: 810 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 810 chars
[Log] 📝 Building initial streaming: 827 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 827 chars
[Log] 📝 Building initial streaming: 852 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 852 chars
[Log] 📝 Building initial streaming: 871 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 871 chars
[Log] 📝 Building initial streaming: 892 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 892 chars
[Log] 📝 Building initial streaming: 910 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 910 chars
[Log] 📝 Building initial streaming: 931 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 931 chars
[Log] 📝 Building initial streaming: 940 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 940 chars
[Log] 📝 Building initial streaming: 949 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 949 chars
[Log] 📝 Building initial streaming: 978 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 978 chars
[Log] 📝 Building initial streaming: 998 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 998 chars
[Log] 📝 Building initial streaming: 1009 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 1009 chars
[Log] 📝 Building initial streaming: 1029 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 1029 chars
[Log] 📝 Building initial streaming: 1035 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 1035 chars
[Log] 📝 Building initial streaming: 1058 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 1058 chars
[Log] 📝 Building initial streaming: 1081 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 1081 chars
[Log] 📝 Building initial streaming: 1090 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 1090 chars
[Log] 📝 Building initial streaming: 1140 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 1140 chars
[Log] 📝 Building initial streaming: 1154 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 1154 chars
[Log] 🔍 TOOL_START DEBUG: toolsStarted=false, streamingText.length=0, streamingMessageId=null
[Log] 🔍 STREAMING CONTENT: "..."
[Log] ❌ TOOL_START: Cannot complete streaming message - condition failed
[Log] ❌ toolsStarted=false, hasStreamingText=false, hasMessageId=false
[Log] 🔧 Tool started: generate_graph_data (toolu_01HcboimGacecQ4HUdhB1r4T) - will create separate tool message
[Log] Tool complete: Setting missing streamingMessageId to msg_012nTHRLrYmW8axTgcNwUCY4
[Log] Tool complete: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 🔄 Starting new message - reset streaming state
[Log] Message start: Set streamingMessageId to msg_01BfVQAeTNkS9Dpj4xSDvWaJ
[Log] 🔍 TOOL_START DEBUG: toolsStarted=false, streamingText.length=0, streamingMessageId=null
[Log] 🔍 STREAMING CONTENT: "..."
[Log] ❌ TOOL_START: Cannot complete streaming message - condition failed
[Log] ❌ toolsStarted=false, hasStreamingText=false, hasMessageId=false
[Log] 🔧 Tool started: generate_table_data (toolu_01QrLabBBBi2i7JWgFGmt36b) - will create separate tool message
[Log] Tool complete: Setting missing streamingMessageId to msg_01BfVQAeTNkS9Dpj4xSDvWaJ
[Log] Tool complete: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 🔄 Starting new message - reset streaming state
[Log] Message start: Set streamingMessageId to msg_01NykRVxs6GoRuRmDBMuq3tq
[Log] 🔍 TOOL_START DEBUG: toolsStarted=false, streamingText.length=0, streamingMessageId=null
[Log] 🔍 STREAMING CONTENT: "..."
[Log] ❌ TOOL_START: Cannot complete streaming message - condition failed
[Log] ❌ toolsStarted=false, hasStreamingText=false, hasMessageId=false
[Log] 🔧 Tool started: generate_financial_metric (toolu_01A3ew5NSndUqRfPbHFvgrsj) - will create separate tool message
[Log] Tool complete: Setting missing streamingMessageId to msg_01NykRVxs6GoRuRmDBMuq3tq
[Log] Tool complete: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 🔄 Starting new message - reset streaming state
[Log] Message start: Set streamingMessageId to msg_014JgsTPcck42npAyJ2wZUXH
[Log] 🔍 TOOL_START DEBUG: toolsStarted=false, streamingText.length=0, streamingMessageId=null
[Log] 🔍 STREAMING CONTENT: "..."
[Log] ❌ TOOL_START: Cannot complete streaming message - condition failed
[Log] ❌ toolsStarted=false, hasStreamingText=false, hasMessageId=false
[Log] 🔧 Tool started: generate_financial_metric (toolu_01UhW2qFXV1DFHVJ6mxZjdnV) - will create separate tool message
[Log] Tool complete: Setting missing streamingMessageId to msg_014JgsTPcck42npAyJ2wZUXH
[Log] Tool complete: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 🔄 Starting new message - reset streaming state
[Log] Message start: Set streamingMessageId to msg_012QMMRSi7L7PDwVzZfSEfEu
[Log] 📝 Building initial streaming: 3 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 3 chars
[Log] 📝 Building initial streaming: 32 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 32 chars
[Log] 📝 Building initial streaming: 40 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 40 chars
[Log] 📝 Building initial streaming: 56 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 56 chars
[Log] 📝 Building initial streaming: 66 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 66 chars
[Log] 📝 Building initial streaming: 72 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 72 chars
[Log] 📝 Building initial streaming: 78 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 78 chars
[Log] 📝 Building initial streaming: 93 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 93 chars
[Log] 📝 Building initial streaming: 113 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 113 chars
[Log] 📝 Building initial streaming: 119 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 119 chars
[Log] 📝 Building initial streaming: 133 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 133 chars
[Log] 📝 Building initial streaming: 145 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 145 chars
[Log] 📝 Building initial streaming: 153 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 153 chars
[Log] 📝 Building initial streaming: 161 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 161 chars
[Log] 📝 Building initial streaming: 184 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 184 chars
[Log] 📝 Building initial streaming: 221 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 221 chars
[Log] 📝 Building initial streaming: 222 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 222 chars
[Log] 📝 Building initial streaming: 227 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 227 chars
[Log] 📝 Building initial streaming: 238 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 238 chars
[Log] 📝 Building initial streaming: 245 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 245 chars
[Log] 📝 Building initial streaming: 248 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 248 chars
[Log] 📝 Building initial streaming: 261 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 261 chars
[Log] 📝 Building initial streaming: 280 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 280 chars
[Log] 📝 Building initial streaming: 289 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 289 chars
[Log] 📝 Building initial streaming: 303 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 303 chars
[Log] 📝 Building initial streaming: 314 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 314 chars
[Log] 📝 Building initial streaming: 319 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 319 chars
[Log] 📝 Building initial streaming: 343 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 343 chars
[Log] 📝 Building initial streaming: 352 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 352 chars
[Log] 📝 Building initial streaming: 353 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 353 chars
[Log] 📝 Building initial streaming: 361 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 361 chars
[Log] 📝 Building initial streaming: 380 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 380 chars
[Log] 📝 Building initial streaming: 390 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 390 chars
[Log] 📝 Building initial streaming: 417 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 417 chars
[Log] 📝 Building initial streaming: 422 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 422 chars
[Log] 📝 Building initial streaming: 430 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 430 chars
[Log] 📝 Building initial streaming: 439 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 439 chars
[Log] 📝 Building initial streaming: 440 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 440 chars
[Log] 📝 Building initial streaming: 448 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 448 chars
[Log] 📝 Building initial streaming: 462 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 462 chars
[Log] 📝 Building initial streaming: 468 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 468 chars
[Log] 📝 Building initial streaming: 491 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 491 chars
[Log] 📝 Building initial streaming: 524 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 524 chars
[Log] 📝 Building initial streaming: 545 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 545 chars
[Log] 📝 Building initial streaming: 561 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 561 chars
[Log] 📝 Building initial streaming: 576 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 576 chars
[Log] 📝 Building initial streaming: 603 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 603 chars
[Log] 📝 Building initial streaming: 629 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 629 chars
[Log] 📝 Building initial streaming: 649 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 649 chars
[Log] 📝 Building initial streaming: 660 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 660 chars
[Log] 📝 Building initial streaming: 687 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 687 chars
[Log] 📝 Building initial streaming: 708 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 708 chars
[Log] 📝 Building initial streaming: 724 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 724 chars
[Log] 📝 Building initial streaming: 741 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 741 chars
[Log] 📝 Building initial streaming: 751 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 751 chars
[Log] 📝 Building initial streaming: 761 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 761 chars
[Log] 📝 Building initial streaming: 767 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 767 chars
[Log] 📝 Building initial streaming: 784 chars
[Log] Content update: Setting missing streamingMessageId to 072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 Initial streaming update: 784 chars
[Log] 🏁 Message complete: toolsStarted=false, messageId=072fbaed-0874-49d1-9cb9-06d9b348b123
[Log] 📝 No tools used - completing streaming message now
[Log] 🧹 Cleaned up streaming state for next message
[Log] PDFViewer unmounting, cleaning up resources
[Log] Sending GET request to http://localhost:8000/api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/citations
[Log] Deprecated API usage: The `enhanceTextSelection` functionality will be removed in the future. (x5)
[Log] Checking 2 messages for cumulative visualization data...
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] Checking 2 messages for cumulative visualization data...
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] PDFViewer unmounting, cleaning up resources
[Log] Checking 2 messages for cumulative visualization data...
[Log] No structured visualization data found in messages or analysis results, returning empty structure
[Log] Checking 2 messages for cumulative visualization data...
[Log] No structured visualization data found in messages or analysis results, returning empty structure
</JavaScript_Console_Output>

<Backend_Logs>
(venv) alexcardell@Alexs-MBP backend % cd /Users/alexcardell/AlexCoding_Local/cfin/backend && PYTHONPATH=$PYTHONPATH:/Users/alexcardell/AlexCoding_Local/cfin/backend python -m uvicorn app.main:app --reload --port 8000
INFO:     Will watch for changes in these directories: ['/Users/alexcardell/AlexCoding_Local/cfin/backend']
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [7259] using StatReload
INFO:root:Loaded environment variables from /Users/alexcardell/AlexCoding_Local/cfin/.env
INFO:root:ANTHROPIC_API_KEY loaded: sk-ant-a...TQAA
INFO:app.main:CORS: Allowing origins: ['http://localhost:3000', 'http://localhost:3001', 'http://localhost:3002', 'http://localhost:3003', 'http://127.0.0.1:3000', 'http://127.0.0.1:3001', 'http://127.0.0.1:3002', 'http://127.0.0.1:3003', 'http://127.0.0.1:49937', 'http://127\\.0\\.0\\.1:\\d+', 'http://127.0.0.1:64142']
INFO:     Started server process [7261]
INFO:     Waiting for application startup.
INFO:app.main:Initializing database...
INFO:utils.init_db:Creating database tables...
INFO:utils.init_db:Database tables created successfully.
INFO:utils.init_db:Default user already exists.
INFO:utils.init_db:Database initialization completed successfully.
INFO:app.main:Database initialization completed successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:62320 - "OPTIONS /api/conversation HTTP/1.1" 200 OK
INFO:     127.0.0.1:62321 - "OPTIONS /api/conversation HTTP/1.1" 200 OK
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.conversation:Created conversation: 00e8c126-e99d-4ee5-8b9b-54c4f1670782 for user: default-user
INFO:app.routes.conversation:Created conversation: e887f5fd-7c23-41ed-bc93-ad1c991fe3e9 for user: default-user
INFO:     127.0.0.1:62320 - "POST /api/conversation HTTP/1.1" 201 Created
INFO:     127.0.0.1:62321 - "POST /api/conversation HTTP/1.1" 201 Created
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:     127.0.0.1:62320 - "GET /api/conversation/e887f5fd-7c23-41ed-bc93-ad1c991fe3e9 HTTP/1.1" 200 OK
INFO:app.routes.websocket:WebSocket endpoint called for conversation: e887f5fd-7c23-41ed-bc93-ad1c991fe3e9, user: default-user
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:     ('127.0.0.1', 62321) - "WebSocket /ws/conversation/e887f5fd-7c23-41ed-bc93-ad1c991fe3e9" [accepted]
INFO:app.routes.websocket:WebSocket connected: default-user_e887f5fd-7c23-41ed-bc93-ad1c991fe3e9_1750480068172
INFO:app.routes.websocket:WebSocket connection established for conversation: e887f5fd-7c23-41ed-bc93-ad1c991fe3e9
INFO:     connection open
INFO:app.routes.websocket:Found conversation: e887f5fd-7c23-41ed-bc93-ad1c991fe3e9
INFO:     127.0.0.1:62322 - "OPTIONS /api/documents/upload HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:utils.storage:File c79dd122-8e9d-4931-a334-b9bc94cf4c80.pdf saved to ./uploads/c79dd122-8e9d-4931-a334-b9bc94cf4c80.pdf
INFO:     127.0.0.1:62322 - "POST /api/documents/upload HTTP/1.1" 200 OK
INFO:pdf_processing.document_service:Starting optimized processing of document c79dd122-8e9d-4931-a334-b9bc94cf4c80 (Bank_5Q_Trend_Report.pdf) with Claude Files API
INFO:pdf_processing.document_service:No cached file_id for document c79dd122-8e9d-4931-a334-b9bc94cf4c80, performing full processing
INFO:pdf_processing.api_service:Processing PDF: Bank_5Q_Trend_Report.pdf with Claude API using native PDF support.
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/files "HTTP/1.1 200 OK"
INFO:utils.file_cache:Cached file_id=file_011CQLjZV5ddRuAZhLrxdkvd for content hash=9c15100a12f1a9ad... (expires: 2025-09-18 23:27:55, cache size: 1)
INFO:audit.pdf_access:PDF_ACCESS: {'timestamp': 'AUTO', 'operation': 'upload', 'file_id': 'file_011CQLjZV5ddRuAZhLrxdkvd', 'user_context': 'system', 'file_size_bytes': 29802, 'privacy_note': 'PDF content not logged for compliance'}
INFO:pdf_processing.claude_file_client:Uploaded Bank_5Q_Trend_Report.pdf (0.0 MB) → file_011CQLjZV5ddRuAZhLrxdkvd
INFO:pdf_processing.api_service:Generated Claude file_id file_011CQLjZV5ddRuAZhLrxdkvd for Bank_5Q_Trend_Report.pdf
INFO:pdf_processing.api_service:Analyzing document type for Bank_5Q_Trend_Report.pdf
INFO:pdf_processing.api_service:Analyzing document type for Bank_5Q_Trend_Report.pdf using file_id=file_011CQLjZV5ddRuAZhLrxdkvd
INFO:pdf_processing.model_router:Using Haiku for light tools set() with 1000 tokens (haiku_calls=1, sonnet_calls=0)
INFO:pdf_processing.api_service:Model router selected claude-3-5-haiku-20241022 for document type analysis
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (non-streaming): 117 (Custom estimate: 117)
INFO:pdf_processing.api_service:Throttling based on token count: 117 (SDK count: 117, Custom estimate: 117)
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
WARNING:pdf_processing.api_service:Invalid document type '['balance_sheet', 'income_statement', 'credit_quality_kpis']', using OTHER
INFO:pdf_processing.api_service:Document Bank_5Q_Trend_Report.pdf classified as other with periods: ['2024Q1', '2024Q2', '2024Q3', '2024Q4', '2025Q1']
INFO:pdf_processing.api_service:Document Bank_5Q_Trend_Report.pdf classified as: other with periods: ['2024Q1', '2024Q2', '2024Q3', '2024Q4', '2025Q1']
INFO:pdf_processing.api_service:Extracting structured financial data and citations for Bank_5Q_Trend_Report.pdf
INFO:pdf_processing.api_service:Extracting structured financial data with citations from: Bank_5Q_Trend_Report.pdf using file_id file_011CQLjZV5ddRuAZhLrxdkvd
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (non-streaming): 177 (Custom estimate: 101)
INFO:pdf_processing.api_service:Throttling based on token count: 177 (SDK count: 177, Custom estimate: 101)
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Successfully parsed financial JSON from Claude's response.
INFO:pdf_processing.api_service:Captured Claude's preamble text, length: 108
INFO:pdf_processing.api_service:Extracted 0 citations for Bank_5Q_Trend_Report.pdf
INFO:pdf_processing.api_service:Structured financial data keys for Bank_5Q_Trend_Report.pdf: ['time_periods', 'balance_sheet', 'income_statement', 'credit_quality', 'claude_textual_output_accompanying_json']
INFO:pdf_processing.api_service:Added claude_file_id file_011CQLjZV5ddRuAZhLrxdkvd to extracted_data for Bank_5Q_Trend_Report.pdf
INFO:pdf_processing.document_service:Processed document using Files API: PDF Bank_5Q_Trend_Report.pdf processed using Claude's native PDF support via Files API
INFO:pdf_processing.document_service:Extracted claude_file_id file_011CQLjZV5ddRuAZhLrxdkvd from processed document data
INFO:pdf_processing.document_service:Stored claude_file_id file_011CQLjZV5ddRuAZhLrxdkvd in database for document c79dd122-8e9d-4931-a334-b9bc94cf4c80
INFO:pdf_processing.document_service:Updating document c79dd122-8e9d-4931-a334-b9bc94cf4c80 content with Claude optimizations using Files API
INFO:pdf_processing.document_service:Document c79dd122-8e9d-4931-a334-b9bc94cf4c80 processed with Claude optimizations. File ID: file_011CQLjZV5ddRuAZhLrxdkvd
INFO:pdf_processing.document_service:Storing 0 citations for document c79dd122-8e9d-4931-a334-b9bc94cf4c80
INFO:pdf_processing.document_service:Successfully completed optimized processing for document c79dd122-8e9d-4931-a334-b9bc94cf4c80
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.document:Document c79dd122-8e9d-4931-a334-b9bc94cf4c80 accepted for financial analysis
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/check-financial-data HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.document:Document c79dd122-8e9d-4931-a334-b9bc94cf4c80 accepted for financial analysis
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/check-financial-data HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "OPTIONS /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/verify-financial-data HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.document:Document c79dd122-8e9d-4931-a334-b9bc94cf4c80 has extracted_data with keys: ['time_periods', 'balance_sheet', 'income_statement', 'credit_quality', 'claude_textual_output_accompanying_json', 'claude_file_id']
INFO:     127.0.0.1:62322 - "POST /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/verify-financial-data HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62322 - "OPTIONS /api/conversation/e887f5fd-7c23-41ed-bc93-ad1c991fe3e9/document/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:services.conversation_service:Found ANTHROPIC_API_KEY in environment variables: sk-ant-a...TQAA
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:     127.0.0.1:62322 - "POST /api/conversation/e887f5fd-7c23-41ed-bc93-ad1c991fe3e9/document/c79dd122-8e9d-4931-a334-b9bc94cf4c80 HTTP/1.1" 200 OK
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.document:Retrieving file for document: c79dd122-8e9d-4931-a334-b9bc94cf4c80
INFO:app.routes.document:Returning binary PDF data for document c79dd122-8e9d-4931-a334-b9bc94cf4c80, size: 29802 bytes
INFO:     127.0.0.1:62322 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/file HTTP/1.1" 200 OK
INFO:     127.0.0.1:62337 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/citations HTTP/1.1" 200 OK
INFO:app.routes.websocket:WEBSOCKET_FLOW: Sent message_start event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: Starting conversation processing for conversation: e887f5fd-7c23-41ed-bc93-ad1c991fe3e9
INFO:repositories.document_repository:Retrieving document content using file path: c79dd122-8e9d-4931-a334-b9bc94cf4c80.pdf
INFO:repositories.document_repository:Requesting file from storage service for document c79dd122-8e9d-4931-a334-b9bc94cf4c80
INFO:repositories.document_repository:Retrieved PDF content for document c79dd122-8e9d-4931-a334-b9bc94cf4c80: 29802 bytes
INFO:repositories.document_repository:Document c79dd122-8e9d-4931-a334-b9bc94cf4c80 has claude_file_id: file_011CQLjZV5ddRuAZhLrxdkvd (native PDF support available)
INFO:repositories.document_repository:PDF document c79dd122-8e9d-4931-a334-b9bc94cf4c80 uses claude_file_id for native support - raw_text not required
INFO:repositories.document_repository:Extracted data available for document c79dd122-8e9d-4931-a334-b9bc94cf4c80: ['time_periods', 'balance_sheet', 'income_statement', 'credit_quality', 'claude_textual_output_accompanying_json', 'claude_file_id']
INFO:repositories.document_repository:Successfully retrieved content for document c79dd122-8e9d-4931-a334-b9bc94cf4c80
INFO:services.conversation_service:Retrieved content for document c79dd122-8e9d-4931-a334-b9bc94cf4c80: content size=29802, raw_text size=0
INFO:services.conversation_service:Document c79dd122-8e9d-4931-a334-b9bc94cf4c80 available content types: content, extracted_data
INFO:services.conversation_service:Added document c79dd122-8e9d-4931-a334-b9bc94cf4c80 to context for conversation e887f5fd-7c23-41ed-bc93-ad1c991fe3e9
INFO:repositories.document_repository:Retrieving document content using file path: c79dd122-8e9d-4931-a334-b9bc94cf4c80.pdf
INFO:repositories.document_repository:Requesting file from storage service for document c79dd122-8e9d-4931-a334-b9bc94cf4c80
INFO:repositories.document_repository:Retrieved PDF content for document c79dd122-8e9d-4931-a334-b9bc94cf4c80: 29802 bytes
INFO:repositories.document_repository:Document c79dd122-8e9d-4931-a334-b9bc94cf4c80 has claude_file_id: file_011CQLjZV5ddRuAZhLrxdkvd (native PDF support available)
INFO:repositories.document_repository:PDF document c79dd122-8e9d-4931-a334-b9bc94cf4c80 uses claude_file_id for native support - raw_text not required
INFO:repositories.document_repository:Extracted data available for document c79dd122-8e9d-4931-a334-b9bc94cf4c80: ['time_periods', 'balance_sheet', 'income_statement', 'credit_quality', 'claude_textual_output_accompanying_json', 'claude_file_id']
INFO:repositories.document_repository:Successfully retrieved content for document c79dd122-8e9d-4931-a334-b9bc94cf4c80
INFO:services.conversation_service:Added document c79dd122-8e9d-4931-a334-b9bc94cf4c80 with Files API file_id: file_011CQLjZV5ddRuAZhLrxdkvd
INFO:services.conversation_service:Using unified streaming approach with tools available for conversation e887f5fd-7c23-41ed-bc93-ad1c991fe3e9
INFO:services.conversation_service:Using Files API claude_file_id file_011CQLjZV5ddRuAZhLrxdkvd for unified streaming analysis
INFO:pdf_processing.api_service:Starting streaming analyze_with_visualization_tools for query: 'How has credit performed?...'
INFO:pdf_processing.api_service:Streaming visualization analysis turn 1/5
INFO:pdf_processing.model_router:Using Sonnet for tools {'generate_financial_metric', 'generate_table_data', 'generate_comparative_period', 'generate_graph_data'} with 46 tokens (haiku_calls=1, sonnet_calls=1)
INFO:pdf_processing.api_service:Executing tool interaction turn with model_router selected model: claude-3-5-sonnet-20241022, 4 tools available, streaming: True
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (streaming): 4321 (Custom estimate: 39)
INFO:pdf_processing.api_service:Throttling based on token count: 4321 (SDK count: 4321, Custom estimate: 39)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
ERROR:sqlalchemy.pool.impl.NullPool:The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-35, started daemon 6208221184)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
/Users/alexcardell/AlexCoding_Local/venv/lib/python3.9/site-packages/pydantic/_internal/_core_utils.py:301: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-35, started daemon 6208221184)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
  for v in schema['choices']:
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting message_start event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 3 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 3
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 3 chars
INFO:services.conversation_service:📝 Content updated: 3 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 3 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 14 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 14
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 14 chars
INFO:services.conversation_service:📝 Content updated: 14 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 14 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 16 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 16
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 16 chars
INFO:services.conversation_service:📝 Content updated: 16 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 16 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 46 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 46
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 46 chars
INFO:services.conversation_service:📝 Content updated: 46 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 46 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 78 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 78
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 78 chars
INFO:services.conversation_service:📝 Content updated: 78 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 78 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 99 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 99
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 99 chars
INFO:services.conversation_service:📝 Content updated: 99 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 99 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 104 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 104
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 104 chars
INFO:services.conversation_service:📝 Content updated: 104 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 104 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 111 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 111
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 111 chars
INFO:services.conversation_service:📝 Content updated: 111 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 111 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 129 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 129
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 129 chars
INFO:services.conversation_service:📝 Content updated: 129 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 129 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 145 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 145
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 145 chars
INFO:services.conversation_service:📝 Content updated: 145 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 145 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 157 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 157
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 157 chars
INFO:services.conversation_service:📝 Content updated: 157 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 157 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 167 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 167
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 167 chars
INFO:services.conversation_service:📝 Content updated: 167 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 167 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 189 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 189
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 189 chars
INFO:services.conversation_service:📝 Content updated: 189 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 189 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 205 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 205
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 205 chars
INFO:services.conversation_service:📝 Content updated: 205 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 205 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 217 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 217
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 217 chars
INFO:services.conversation_service:📝 Content updated: 217 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 217 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 228 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 228
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 228 chars
INFO:services.conversation_service:📝 Content updated: 228 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 228 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 250 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 250
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 250 chars
INFO:services.conversation_service:📝 Content updated: 250 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 250 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 261 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 261
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 261 chars
INFO:services.conversation_service:📝 Content updated: 261 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 261 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 289 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 289
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 289 chars
INFO:services.conversation_service:📝 Content updated: 289 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 289 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 299 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 299
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 299 chars
INFO:services.conversation_service:📝 Content updated: 299 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 299 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 309 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 309
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 309 chars
INFO:services.conversation_service:📝 Content updated: 309 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 309 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 327 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 327
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 327 chars
INFO:services.conversation_service:📝 Content updated: 327 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 327 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 350 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 350
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 350 chars
INFO:services.conversation_service:📝 Content updated: 350 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 350 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 368 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 368
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 368 chars
INFO:services.conversation_service:📝 Content updated: 368 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 368 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 376 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 376
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 376 chars
INFO:services.conversation_service:📝 Content updated: 376 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 376 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 382 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 382
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 382 chars
INFO:services.conversation_service:📝 Content updated: 382 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 382 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 390 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 390
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 390 chars
INFO:services.conversation_service:📝 Content updated: 390 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 390 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 399 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 399
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 399 chars
INFO:services.conversation_service:📝 Content updated: 399 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 399 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 406 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 406
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 406 chars
INFO:services.conversation_service:📝 Content updated: 406 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 406 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 440 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 440
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 440 chars
INFO:services.conversation_service:📝 Content updated: 440 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 440 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 452 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 452
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 452 chars
INFO:services.conversation_service:📝 Content updated: 452 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 452 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 469 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 469
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 469 chars
INFO:services.conversation_service:📝 Content updated: 469 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 469 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 500 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 500
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 500 chars
INFO:services.conversation_service:📝 Content updated: 500 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 500 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 525 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 525
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 525 chars
INFO:services.conversation_service:📝 Content updated: 525 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 525 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 536 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 536
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 536 chars
INFO:services.conversation_service:📝 Content updated: 536 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 536 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 563 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 563
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 563 chars
INFO:services.conversation_service:📝 Content updated: 563 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 563 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 592 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 592
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 592 chars
INFO:services.conversation_service:📝 Content updated: 592 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 592 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 620 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 620
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 620 chars
INFO:services.conversation_service:📝 Content updated: 620 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 620 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 639 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 639
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 639 chars
INFO:services.conversation_service:📝 Content updated: 639 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 639 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 648 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 648
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 648 chars
INFO:services.conversation_service:📝 Content updated: 648 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 648 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 655 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 655
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 655 chars
INFO:services.conversation_service:📝 Content updated: 655 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 655 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 685 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 685
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 685 chars
INFO:services.conversation_service:📝 Content updated: 685 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 685 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 701 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 701
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 701 chars
INFO:services.conversation_service:📝 Content updated: 701 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 701 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 721 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 721
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 721 chars
INFO:services.conversation_service:📝 Content updated: 721 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 721 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 736 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 736
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 736 chars
INFO:services.conversation_service:📝 Content updated: 736 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 736 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 765 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 765
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 765 chars
INFO:services.conversation_service:📝 Content updated: 765 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 765 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 793 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 793
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 793 chars
INFO:services.conversation_service:📝 Content updated: 793 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 793 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 810 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 810
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 810 chars
INFO:services.conversation_service:📝 Content updated: 810 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 810 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 827 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 827
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 827 chars
INFO:services.conversation_service:📝 Content updated: 827 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 827 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 852 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 852
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 852 chars
INFO:services.conversation_service:📝 Content updated: 852 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 852 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 871 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 871
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 871 chars
INFO:services.conversation_service:📝 Content updated: 871 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 871 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 892 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 892
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 892 chars
INFO:services.conversation_service:📝 Content updated: 892 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 892 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 910 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 910
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 910 chars
INFO:services.conversation_service:📝 Content updated: 910 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 910 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 931 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 931
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 931 chars
INFO:services.conversation_service:📝 Content updated: 931 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 931 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 940 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 940
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 940 chars
INFO:services.conversation_service:📝 Content updated: 940 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 940 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 949 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 949
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 949 chars
INFO:services.conversation_service:📝 Content updated: 949 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 949 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 978 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 978
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 978 chars
INFO:services.conversation_service:📝 Content updated: 978 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 978 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 998 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 998
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 998 chars
INFO:services.conversation_service:📝 Content updated: 998 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 998 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1009 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 1009
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1009 chars
INFO:services.conversation_service:📝 Content updated: 1009 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1009 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1029 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 1029
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1029 chars
INFO:services.conversation_service:📝 Content updated: 1029 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1029 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1035 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 1035
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1035 chars
INFO:services.conversation_service:📝 Content updated: 1035 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1035 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1058 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 1058
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1058 chars
INFO:services.conversation_service:📝 Content updated: 1058 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1058 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1081 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 1081
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1081 chars
INFO:services.conversation_service:📝 Content updated: 1081 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1081 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1090 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 1090
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1090 chars
INFO:services.conversation_service:📝 Content updated: 1090 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1090 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1140 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 1140
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1140 chars
INFO:services.conversation_service:📝 Content updated: 1140 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1140 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 1154 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 1154
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 1154 chars
INFO:services.conversation_service:📝 Content updated: 1154 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 1154 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_start event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_start - tool_id=toolu_01HcboimGacecQ4HUdhB1r4T, tool_name=generate_graph_data
INFO:pdf_processing.api_service:Raw tool input from Claude for generate_graph_data: type=<class 'dict'>
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: msg_012nTHRLrYmW8axTgcNwUCY4
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01HcboimGacecQ4HUdhB1r4T, tool_name=generate_graph_data
INFO:pdf_processing.api_service:Turn 1: Initial streaming text preserved (1154 chars)
INFO:pdf_processing.api_service:Received 1 tool calls from streaming response
INFO:pdf_processing.api_service:Tool call: generate_graph_data (ID: toolu_01HcboimGacecQ4HUdhB1r4T)
INFO:pdf_processing.api_service:Processing streaming tool generate_graph_data (ID: toolu_01HcboimGacecQ4HUdhB1r4T)
INFO:pdf_processing.api_service:Tool generate_graph_data (ID: toolu_01HcboimGacecQ4HUdhB1r4T) - input type: <class 'dict'>
INFO:pdf_processing.api_service:Tool generate_graph_data (ID: toolu_01HcboimGacecQ4HUdhB1r4T) - dict input keys: ['chartType', 'config', 'data', 'chartConfig']
INFO:utils.tool_processing:Processing generate_graph_data (ID: toolu_01HcboimGacecQ4HUdhB1r4T) - input type: <class 'dict'>
INFO:utils.tool_processing:Starting process_chart_input with input type: <class 'dict'>
INFO:utils.tool_processing:Chart input keys: ['chartType', 'config', 'data', 'chartConfig']
INFO:utils.tool_processing:Chart config type: <class 'str'>
INFO:utils.tool_processing:Chart data type: <class 'list'>, length: 5
INFO:utils.tool_processing:Chart chartConfig type: <class 'dict'>
WARNING:utils.tool_processing:Chart config is a JSON string, parsing it
INFO:utils.tool_processing:Successfully parsed config JSON string
INFO:utils.tool_processing:Chart config keys: ['title', 'xAxisKey', 'xAxisLabel', 'yAxisLabel', 'description']
INFO:utils.tool_processing:Successfully got original_data: type=<class 'list'>
INFO:utils.tool_processing:Chart type: line
INFO:utils.tool_processing:Chart config settings type: <class 'dict'>
INFO:utils.tool_processing:x_axis_key: period
INFO:utils.tool_processing:Transforming chart data to {x, y} format required by ChartDataItem model
INFO:utils.tool_processing:Line chart with multiple series (['npa', 'nonaccrual', 'pastdue']) - keeping flat format
INFO:utils.tool_processing:Successfully processed chart: Credit Quality Trends
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01HcboimGacecQ4HUdhB1r4T, tool_name=generate_graph_data
INFO:pdf_processing.api_service:Streaming visualization analysis turn 2/5
INFO:pdf_processing.model_router:Using Sonnet for tools {'generate_financial_metric', 'generate_table_data', 'generate_comparative_period', 'generate_graph_data'} with 895 tokens (haiku_calls=1, sonnet_calls=2)
INFO:pdf_processing.api_service:Executing tool interaction turn with model_router selected model: claude-3-5-sonnet-20241022, 4 tools available, streaming: True
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (streaming): 5446 (Custom estimate: 328)
INFO:pdf_processing.api_service:Throttling based on token count: 5446 (SDK count: 5446, Custom estimate: 328)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting message_start event with message_id: msg_01BfVQAeTNkS9Dpj4xSDvWaJ
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_start event with message_id: msg_01BfVQAeTNkS9Dpj4xSDvWaJ
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_start - tool_id=toolu_01QrLabBBBi2i7JWgFGmt36b, tool_name=generate_table_data
INFO:pdf_processing.api_service:Raw tool input from Claude for generate_table_data: type=<class 'dict'>
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: msg_01BfVQAeTNkS9Dpj4xSDvWaJ
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01QrLabBBBi2i7JWgFGmt36b, tool_name=generate_table_data
INFO:pdf_processing.api_service:Received 1 tool calls from streaming response
INFO:pdf_processing.api_service:Tool call: generate_table_data (ID: toolu_01QrLabBBBi2i7JWgFGmt36b)
INFO:pdf_processing.api_service:Processing streaming tool generate_table_data (ID: toolu_01QrLabBBBi2i7JWgFGmt36b)
INFO:pdf_processing.api_service:Tool generate_table_data (ID: toolu_01QrLabBBBi2i7JWgFGmt36b) - input type: <class 'dict'>
INFO:pdf_processing.api_service:Tool generate_table_data (ID: toolu_01QrLabBBBi2i7JWgFGmt36b) - dict input keys: ['tableType', 'config', 'data']
INFO:utils.tool_processing:Processing generate_table_data (ID: toolu_01QrLabBBBi2i7JWgFGmt36b) - input type: <class 'dict'>
INFO:utils.tool_processing:Starting process_table_input with input type: <class 'dict'>
INFO:utils.tool_processing:Table input keys: ['tableType', 'config', 'data']
INFO:utils.tool_processing:Table config type: <class 'str'>
INFO:utils.tool_processing:Table data type: <class 'list'>, length: 5
WARNING:utils.tool_processing:Table config is a JSON string, parsing it
INFO:utils.tool_processing:Successfully parsed table config JSON string
INFO:utils.tool_processing:Successfully processed table: Credit Quality Metrics
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01QrLabBBBi2i7JWgFGmt36b, tool_name=generate_table_data
INFO:pdf_processing.api_service:Streaming visualization analysis turn 3/5
INFO:pdf_processing.model_router:Using Sonnet for tools {'generate_financial_metric', 'generate_table_data', 'generate_comparative_period', 'generate_graph_data'} with 1563 tokens (haiku_calls=1, sonnet_calls=3)
INFO:pdf_processing.api_service:Executing tool interaction turn with model_router selected model: claude-3-5-sonnet-20241022, 4 tools available, streaming: True
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (streaming): 6509 (Custom estimate: 328)
INFO:pdf_processing.api_service:Throttling based on token count: 6509 (SDK count: 6509, Custom estimate: 328)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting message_start event with message_id: msg_01NykRVxs6GoRuRmDBMuq3tq
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_start event with message_id: msg_01NykRVxs6GoRuRmDBMuq3tq
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_start - tool_id=toolu_01A3ew5NSndUqRfPbHFvgrsj, tool_name=generate_financial_metric
INFO:pdf_processing.api_service:Raw tool input from Claude for generate_financial_metric: type=<class 'dict'>
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: msg_01NykRVxs6GoRuRmDBMuq3tq
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01A3ew5NSndUqRfPbHFvgrsj, tool_name=generate_financial_metric
INFO:pdf_processing.api_service:Received 1 tool calls from streaming response
INFO:pdf_processing.api_service:Tool call: generate_financial_metric (ID: toolu_01A3ew5NSndUqRfPbHFvgrsj)
INFO:pdf_processing.api_service:Processing streaming tool generate_financial_metric (ID: toolu_01A3ew5NSndUqRfPbHFvgrsj)
INFO:pdf_processing.api_service:Tool generate_financial_metric (ID: toolu_01A3ew5NSndUqRfPbHFvgrsj) - input type: <class 'dict'>
INFO:pdf_processing.api_service:Tool generate_financial_metric (ID: toolu_01A3ew5NSndUqRfPbHFvgrsj) - dict input keys: ['category', 'name', 'period', 'value', 'unit', 'isEstimated']
INFO:utils.tool_processing:Processing generate_financial_metric (ID: toolu_01A3ew5NSndUqRfPbHFvgrsj) - input type: <class 'dict'>
INFO:utils.tool_processing:Successfully processed financial metric: Net Charge-off Rate
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01A3ew5NSndUqRfPbHFvgrsj, tool_name=generate_financial_metric
INFO:pdf_processing.api_service:Streaming visualization analysis turn 4/5
INFO:pdf_processing.model_router:Using Sonnet for tools {'generate_financial_metric', 'generate_table_data', 'generate_comparative_period', 'generate_graph_data'} with 1678 tokens (haiku_calls=1, sonnet_calls=4)
INFO:pdf_processing.api_service:Executing tool interaction turn with model_router selected model: claude-3-5-sonnet-20241022, 4 tools available, streaming: True
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (streaming): 6722 (Custom estimate: 328)
INFO:pdf_processing.api_service:Throttling based on token count: 6722 (SDK count: 6722, Custom estimate: 328)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting message_start event with message_id: msg_014JgsTPcck42npAyJ2wZUXH
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_start event with message_id: msg_014JgsTPcck42npAyJ2wZUXH
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_start - tool_id=toolu_01UhW2qFXV1DFHVJ6mxZjdnV, tool_name=generate_financial_metric
INFO:pdf_processing.api_service:Raw tool input from Claude for generate_financial_metric: type=<class 'dict'>
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: msg_014JgsTPcck42npAyJ2wZUXH
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01UhW2qFXV1DFHVJ6mxZjdnV, tool_name=generate_financial_metric
INFO:pdf_processing.api_service:Received 1 tool calls from streaming response
INFO:pdf_processing.api_service:Tool call: generate_financial_metric (ID: toolu_01UhW2qFXV1DFHVJ6mxZjdnV)
INFO:pdf_processing.api_service:Processing streaming tool generate_financial_metric (ID: toolu_01UhW2qFXV1DFHVJ6mxZjdnV)
INFO:pdf_processing.api_service:Tool generate_financial_metric (ID: toolu_01UhW2qFXV1DFHVJ6mxZjdnV) - input type: <class 'dict'>
INFO:pdf_processing.api_service:Tool generate_financial_metric (ID: toolu_01UhW2qFXV1DFHVJ6mxZjdnV) - dict input keys: ['category', 'name', 'period', 'value', 'unit', 'isEstimated']
INFO:utils.tool_processing:Processing generate_financial_metric (ID: toolu_01UhW2qFXV1DFHVJ6mxZjdnV) - input type: <class 'dict'>
INFO:utils.tool_processing:Successfully processed financial metric: Non-Performing Assets Ratio
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting tool_complete event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: tool_complete - tool_id=toolu_01UhW2qFXV1DFHVJ6mxZjdnV, tool_name=generate_financial_metric
INFO:pdf_processing.api_service:Streaming visualization analysis turn 5/5
INFO:pdf_processing.model_router:Using Sonnet for tools {'generate_financial_metric', 'generate_table_data', 'generate_comparative_period', 'generate_graph_data'} with 1797 tokens (haiku_calls=1, sonnet_calls=5)
INFO:pdf_processing.api_service:Executing tool interaction turn with model_router selected model: claude-3-5-sonnet-20241022, 4 tools available, streaming: True
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages/count_tokens "HTTP/1.1 200 OK"
INFO:pdf_processing.api_service:Anthropic SDK estimated input tokens (streaming): 6937 (Custom estimate: 328)
INFO:pdf_processing.api_service:Throttling based on token count: 6937 (SDK count: 6937, Custom estimate: 328)
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting message_start event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 3 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 3
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 3 chars
INFO:services.conversation_service:📝 Content updated: 3 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 3 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 32 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 32
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 32 chars
INFO:services.conversation_service:📝 Content updated: 32 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 32 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 40 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 40
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 40 chars
INFO:services.conversation_service:📝 Content updated: 40 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 40 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 56 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 56
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 56 chars
INFO:services.conversation_service:📝 Content updated: 56 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 56 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 66 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 66
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 66 chars
INFO:services.conversation_service:📝 Content updated: 66 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 66 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 72 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 72
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 72 chars
INFO:services.conversation_service:📝 Content updated: 72 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 72 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 78 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 78
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 78 chars
INFO:services.conversation_service:📝 Content updated: 78 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 78 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 93 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 93
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 93 chars
INFO:services.conversation_service:📝 Content updated: 93 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 93 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 113 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 113
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 113 chars
INFO:services.conversation_service:📝 Content updated: 113 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 113 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 119 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 119
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 119 chars
INFO:services.conversation_service:📝 Content updated: 119 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 119 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 133 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 133
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 133 chars
INFO:services.conversation_service:📝 Content updated: 133 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 133 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 145 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 145
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 145 chars
INFO:services.conversation_service:📝 Content updated: 145 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 145 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 153 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 153
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 153 chars
INFO:services.conversation_service:📝 Content updated: 153 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 153 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 161 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 161
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 161 chars
INFO:services.conversation_service:📝 Content updated: 161 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 161 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 184 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 184
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 184 chars
INFO:services.conversation_service:📝 Content updated: 184 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 184 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 221 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 221
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 221 chars
INFO:services.conversation_service:📝 Content updated: 221 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 221 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 222 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 222
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 222 chars
INFO:services.conversation_service:📝 Content updated: 222 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 222 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 227 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 227
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 227 chars
INFO:services.conversation_service:📝 Content updated: 227 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 227 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 238 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 238
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 238 chars
INFO:services.conversation_service:📝 Content updated: 238 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 238 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 245 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 245
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 245 chars
INFO:services.conversation_service:📝 Content updated: 245 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 245 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 248 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 248
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 248 chars
INFO:services.conversation_service:📝 Content updated: 248 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 248 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 261 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 261
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 261 chars
INFO:services.conversation_service:📝 Content updated: 261 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 261 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 280 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 280
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 280 chars
INFO:services.conversation_service:📝 Content updated: 280 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 280 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 289 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 289
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 289 chars
INFO:services.conversation_service:📝 Content updated: 289 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 289 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 303 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 303
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 303 chars
INFO:services.conversation_service:📝 Content updated: 303 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 303 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 314 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 314
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 314 chars
INFO:services.conversation_service:📝 Content updated: 314 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 314 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 319 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 319
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 319 chars
INFO:services.conversation_service:📝 Content updated: 319 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 319 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 343 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 343
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 343 chars
INFO:services.conversation_service:📝 Content updated: 343 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 343 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 352 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 352
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 352 chars
INFO:services.conversation_service:📝 Content updated: 352 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 352 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 353 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 353
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 353 chars
INFO:services.conversation_service:📝 Content updated: 353 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 353 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 361 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 361
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 361 chars
INFO:services.conversation_service:📝 Content updated: 361 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 361 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 380 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 380
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 380 chars
INFO:services.conversation_service:📝 Content updated: 380 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 380 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 390 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 390
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 390 chars
INFO:services.conversation_service:📝 Content updated: 390 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 390 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 417 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 417
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 417 chars
INFO:services.conversation_service:📝 Content updated: 417 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 417 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 422 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 422
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 422 chars
INFO:services.conversation_service:📝 Content updated: 422 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 422 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 430 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 430
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 430 chars
INFO:services.conversation_service:📝 Content updated: 430 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 430 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 439 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 439
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 439 chars
INFO:services.conversation_service:📝 Content updated: 439 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 439 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 440 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 440
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 440 chars
INFO:services.conversation_service:📝 Content updated: 440 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 440 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 448 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 448
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 448 chars
INFO:services.conversation_service:📝 Content updated: 448 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 448 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 462 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 462
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 462 chars
INFO:services.conversation_service:📝 Content updated: 462 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 462 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 468 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 468
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 468 chars
INFO:services.conversation_service:📝 Content updated: 468 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 468 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 491 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 491
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 491 chars
INFO:services.conversation_service:📝 Content updated: 491 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 491 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 524 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 524
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 524 chars
INFO:services.conversation_service:📝 Content updated: 524 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 524 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 545 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 545
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 545 chars
INFO:services.conversation_service:📝 Content updated: 545 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 545 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 561 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 561
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 561 chars
INFO:services.conversation_service:📝 Content updated: 561 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 561 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 576 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 576
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 576 chars
INFO:services.conversation_service:📝 Content updated: 576 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 576 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 603 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 603
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 603 chars
INFO:services.conversation_service:📝 Content updated: 603 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 603 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 629 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 629
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 629 chars
INFO:services.conversation_service:📝 Content updated: 629 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 629 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 649 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 649
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 649 chars
INFO:services.conversation_service:📝 Content updated: 649 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 649 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 660 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 660
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 660 chars
INFO:services.conversation_service:📝 Content updated: 660 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 660 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 687 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 687
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 687 chars
INFO:services.conversation_service:📝 Content updated: 687 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 687 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 708 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 708
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 708 chars
INFO:services.conversation_service:📝 Content updated: 708 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 708 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 724 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 724
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 724 chars
INFO:services.conversation_service:📝 Content updated: 724 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 724 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 741 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 741
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 741 chars
INFO:services.conversation_service:📝 Content updated: 741 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 741 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 751 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 751
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 751 chars
INFO:services.conversation_service:📝 Content updated: 751 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 751 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 761 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 761
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 761 chars
INFO:services.conversation_service:📝 Content updated: 761 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 761 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 767 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 767
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 767 chars
INFO:services.conversation_service:📝 Content updated: 767 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 767 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting text_delta event with message_id: msg_012QMMRSi7L7PDwVzZfSEfEu
INFO:app.routes.websocket:WEBSOCKET_FLOW: text_delta content length: 784 chars
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 784
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 784 chars
INFO:services.conversation_service:📝 Content updated: 784 chars
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting content_update event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: content_update content length: 784 chars
INFO:pdf_processing.api_service:Turn 5: Adding new content (784 chars)
INFO:pdf_processing.api_service:Streaming visualization analysis completed: no more tools
INFO:pdf_processing.api_service:Streaming visualization analysis completed: 1 charts, 1 tables, 2 metrics. Analysis text length: 1940
INFO:services.conversation_service:Current assistant message content length: 784
INFO:services.conversation_service:Analysis text length: 1940
INFO:services.conversation_service:📝 Using streaming content (784 chars)
INFO:repositories.conversation_repository:Updated and re-fetched message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:repositories.conversation_repository:Message content length: 784
INFO:repositories.conversation_repository:Analysis blocks count: 0
INFO:repositories.conversation_repository:Content update verified: 784 chars
INFO:services.conversation_service:✅ Database updated with final content: 784 chars
INFO:services.conversation_service:Sent message_update event for 072fbaed-0874-49d1-9cb9-06d9b348b123 after streaming complete
INFO:services.conversation_service:DEBUG: result.get('metrics'): [{'category': 'Credit Quality', 'name': 'Net Charge-off Rate', 'period': '2025Q1', 'value': 0.071, 'unit': '%', 'isEstimated': True}, {'category': 'Credit Quality', 'name': 'Non-Performing Assets Ratio', 'period': '2025Q1', 'value': 0.87, 'unit': '%', 'isEstimated': True}]
INFO:services.conversation_service:DEBUG: accumulated_metrics: [{'category': 'Credit Quality', 'name': 'Net Charge-off Rate', 'period': '2025Q1', 'value': 0.071, 'unit': '%', 'isEstimated': True}, {'category': 'Credit Quality', 'name': 'Non-Performing Assets Ratio', 'period': '2025Q1', 'value': 0.87, 'unit': '%', 'isEstimated': True}]
INFO:services.conversation_service:Processing visualizations for conversation e887f5fd-7c23-41ed-bc93-ad1c991fe3e9: charts=1, tables=1, metrics=2
INFO:services.conversation_service:Processing chart: Credit Quality Trends
INFO:services.conversation_service:Processing table: Credit Quality Metrics
INFO:services.conversation_service:Processing metric: Net Charge-off Rate
INFO:services.conversation_service:Processing metric: Non-Performing Assets Ratio
INFO:services.conversation_service:Storing 4 analysis blocks for streaming message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:services.conversation_service:ATOMIC: Using existing transaction for message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:services.conversation_service:ATOMIC: Refreshed message 072fbaed-0874-49d1-9cb9-06d9b348b123 content length: 784 chars
INFO:repositories.conversation_repository:Added analysis block 'Credit Quality Trends' (type: chart) to message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:services.conversation_service:ATOMIC: Stored analysis block 1/4: Credit Quality Trends
INFO:repositories.conversation_repository:Added analysis block 'Credit Quality Metrics' (type: table) to message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:services.conversation_service:ATOMIC: Stored analysis block 2/4: Credit Quality Metrics
INFO:repositories.conversation_repository:Added analysis block 'Net Charge-off Rate' (type: metric) to message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:services.conversation_service:ATOMIC: Stored analysis block 3/4: Net Charge-off Rate
INFO:repositories.conversation_repository:Added analysis block 'Non-Performing Assets Ratio' (type: metric) to message 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:services.conversation_service:ATOMIC: Stored analysis block 4/4: Non-Performing Assets Ratio
INFO:services.conversation_service:ATOMIC: Transaction complete - message 072fbaed-0874-49d1-9cb9-06d9b348b123 has 4 analysis blocks
INFO:services.conversation_service:Sending message_complete event for conversation e887f5fd-7c23-41ed-bc93-ad1c991fe3e9 after analysis blocks stored
INFO:app.routes.websocket:WEBSOCKET_FLOW: Emitting message_complete event with message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:services.conversation_service:message_complete event sent for conversation e887f5fd-7c23-41ed-bc93-ad1c991fe3e9 after analysis blocks
INFO:app.routes.websocket:WEBSOCKET_FLOW: Streaming message processing completed for message_id: 072fbaed-0874-49d1-9cb9-06d9b348b123
INFO:app.routes.websocket:WEBSOCKET_FLOW: Conversation e887f5fd-7c23-41ed-bc93-ad1c991fe3e9 processing finished successfully
INFO:pdf_processing.api_service:ClaudeService initialized with model: claude-3-5-sonnet-20241022, PDF support, timeout=90s, max_retries=5, headers: {'anthropic-beta': 'token-efficient-tools-2025-02-19,files-api-2025-04-14,fine-grained-tool-streaming-2025-05-14'}
INFO:pdf_processing.langgraph_service:LangGraphService initialized with model: claude-3-5-sonnet-20241022
INFO:pdf_processing.api_service:LangGraph service successfully initialized
INFO:app.routes.document:Retrieving file for document: c79dd122-8e9d-4931-a334-b9bc94cf4c80
INFO:app.routes.document:Returning binary PDF data for document c79dd122-8e9d-4931-a334-b9bc94cf4c80, size: 29802 bytes
INFO:     127.0.0.1:62360 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/citations HTTP/1.1" 200 OK
INFO:     127.0.0.1:62359 - "GET /api/documents/c79dd122-8e9d-4931-a334-b9bc94cf4c80/file HTTP/1.1" 200 OK
</Backend_Logs>